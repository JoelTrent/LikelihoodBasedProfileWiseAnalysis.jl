<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initialisation · LikelihoodBasedProfileWiseAnalysis.jl</title><meta name="title" content="Initialisation · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="og:title" content="Initialisation · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="twitter:title" content="Initialisation · LikelihoodBasedProfileWiseAnalysis.jl"/><meta name="description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="twitter:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/initialisation/"/><meta property="twitter:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/initialisation/"/><link rel="canonical" href="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/initialisation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LikelihoodBasedProfileWiseAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../workflow_background/">Workflow Background</a></li><li><span class="tocitem">User Interface</span><ul><li class="is-active"><a class="tocitem" href>Initialisation</a><ul class="internal"><li><a class="tocitem" href="#Model-Initialisation"><span>Model Initialisation</span></a></li><li><a class="tocitem" href="#Model-Representation"><span>Model Representation</span></a></li><li><a class="tocitem" href="#Ellipse-Approximation"><span>Ellipse Approximation</span></a></li><li><a class="tocitem" href="#Modifying-Parameter-Magnitudes-and-Bounds"><span>Modifying Parameter Magnitudes and Bounds</span></a></li><li><a class="tocitem" href="#Parameter-Transformations"><span>Parameter Transformations</span></a></li><li><a class="tocitem" href="#Optimization-Settings"><span>Optimization Settings</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Parameter Profiles and Samples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../profiles_and_samples/profile_structs/">Structs and Profile Types</a></li><li><a class="tocitem" href="../profiles_and_samples/univariate/">Univariate Profiles</a></li><li><a class="tocitem" href="../profiles_and_samples/bivariate/">Bivariate Profiles</a></li><li><a class="tocitem" href="../profiles_and_samples/dimensional/">Dimensional Samples</a></li></ul></li><li><a class="tocitem" href="../predictions/">Predictions</a></li><li><a class="tocitem" href="../plots/">Plots</a></li><li><a class="tocitem" href="../saving_and_loading/">Saving and Loading LikelihoodModels</a></li><li><a class="tocitem" href="../timing_and_profiling/">Timing and Profiling</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Simulated Coverage Checks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../coverage/univariate_intervals/">Parameter Confidence Intervals</a></li><li><a class="tocitem" href="../coverage/bivariate_boundaries/">Bivariate Parameter Confidence Boundaries</a></li><li><a class="tocitem" href="../coverage/predictions_and_realisations/">Predictions and Realisations</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/">Initial Setup</a></li><li><a class="tocitem" href="../../examples/logistic/">Logistic Model</a></li><li><a class="tocitem" href="../../examples/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../../examples/two-species_logistic/">Two-Species Logistic Model</a></li><li><a class="tocitem" href="../../examples/binomial_normal_approximation/">Gaussian Approximation of a Binomial Distribution</a></li><li><a class="tocitem" href="../../examples/logistic_timing_estimates/">Function Evaluation Timing - Logistic Model</a></li></ul></li><li><span class="tocitem">Internal Library</span><ul><li><a class="tocitem" href="../../internal_library/common/">Common Functions</a></li><li><a class="tocitem" href="../../internal_library/initialisation/">Initialisation</a></li><li><a class="tocitem" href="../../internal_library/ellipse_likelihood/">Ellipse Functions</a></li><li><a class="tocitem" href="../../internal_library/univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../../internal_library/bivariate/">Bivariate Functions</a></li><li><a class="tocitem" href="../../internal_library/dimensional/">Dimensional Functions</a></li><li><a class="tocitem" href="../../internal_library/predictions/">Prediction Functions</a></li><li><a class="tocitem" href="../../internal_library/plots/">Plotting Functions</a></li><li><a class="tocitem" href="../../internal_library/coverage/">Coverage Functions</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Interface</a></li><li class="is-active"><a href>Initialisation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initialisation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/main/docs/src/user_interface/initialisation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Initialisation"><a class="docs-heading-anchor" href="#Initialisation">Initialisation</a><a id="Initialisation-1"></a><a class="docs-heading-anchor-permalink" href="#Initialisation" title="Permalink"></a></h1><h2 id="Model-Initialisation"><a class="docs-heading-anchor" href="#Model-Initialisation">Model Initialisation</a><a id="Model-Initialisation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Initialisation" title="Permalink"></a></h2><p>To initialise a model for profile likelihood evaluation we use <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a> which returns a struct of type <a href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a>. This struct contains all the information we require for the PWA workflow and will also contain computed profiles and profile-wise predictions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel" href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialise_LikelihoodModel(loglikefunction::Function,
    predictfunction::Union{Function, Missing},
    errorfunction::Union{Function, Missing}
    data::Union{Tuple, NamedTuple},
    θnams::Vector{&lt;:Symbol},
    θinitialguess::AbstractVector{&lt;:Real},
    θlb::AbstractVector{&lt;:Real},
    θub::AbstractVector{&lt;:Real},
    θmagnitudes::AbstractVector{&lt;:Real}=Float64[];
    &lt;keyword arguments&gt;)</code></pre><p>Initialises a <a href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct, which contains all model information, profiles, samples and predictions. Solves for the maximum likelihood estimate of <code>loglikefunction</code>.</p><p><strong>Arguments</strong></p><ul><li><code>loglikefunction</code>: a log-likelihood function to maximise which takes two arguments, <code>θ</code> and <code>data</code>, in that order, where θ is a vector containing the values of each parameter in <code>θnames</code> and <code>data</code> is a Tuple or NamedTuple - see <code>data</code> below. Set up to be used in a maximisation objective.</li><li><code>predictfunction</code>: a prediction function to generate model predictions from that is paired with the <code>loglikefunction</code>. Requirements for the prediction function can be seen in <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_prediction_function!"><code>add_prediction_function!</code></a>. It can also be <code>missing</code> if no function is provided to <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a>, because predictions are not required when evaluating parameter profiles. The function can be added at a later point using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_prediction_function!"><code>add_prediction_function!</code></a>.</li><li><code>errorfunction</code>: an error function used to predict realisations from predictions generated with <code>predictfunction</code>. Requirements for the error function can be seen in <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_error_function!"><code>add_error_function!</code></a>. It can also be <code>missing</code> if no function is provided to <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a>, because predictions are not required when evaluating parameter profiles. The function can be added at a later point using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_error_function!"><code>add_error_function!</code></a>.</li><li><code>data</code>: a Tuple or a NamedTuple containing any additional information required by the log-likelihood function, such as the time points to be evaluated at.</li><li><code>θnames</code>: a vector of symbols containing the names of each parameter, e.g. <code>[:λ, :K, :C0]</code>.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point.</li><li><code>θlb</code>: a vector of lower bounds on parameters. </li><li><code>θub</code>: a vector of upper bounds on parameters. </li><li><code>θmagnitudes</code>: a vector of the relative magnitude of each parameter. If not provided, it will be estimated using the difference of <code>θlb</code> and <code>θub</code> with <a href="../../internal_library/initialisation/#LikelihoodBasedProfileWiseAnalysis.calculate_θmagnitudes"><code>LikelihoodBasedProfileWiseAnalysis.calculate_θmagnitudes</code></a>. Can be updated after initialisation using <a href="#LikelihoodBasedProfileWiseAnalysis.setmagnitudes!"><code>setmagnitudes!</code></a>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>optimizationsettings</code>: optimization settings used to optimize the log-likelihood function using <a href="https://docs.sciml.ai/Optimization/stable/">Optimization.jl</a>. Default is <code>default_OptimizationSettings()</code> (see <a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>uni_row_prealloaction_size</code>: number of rows of <code>uni_profiles_df</code> to preallocate. Default is <code>missing</code> (a single row).</li><li><code>biv_row_preallocation_size</code>: number of rows of <code>biv_profiles_df</code> to preallocate. Default is <code>missing</code> (a single row).</li><li><code>dim_row_preallocation_size</code>: number of rows of <code>dim_samples_df</code> to preallocate. Default is <code>missing</code> (a single row).</li><li><code>find_zero_atol</code>: a <code>Real</code> number greater than zero for the absolute tolerance of the log-likelihood function value from the target value to be used when searching for confidence intervals/boundaries. Default is <code>0.001</code>.</li><li><code>show_progress</code>: Whether to show the progress of profiling and predictions. </li></ul><div class="admonition is-info"><header class="admonition-header">Array initialisation within a log-likelihood function</header><div class="admonition-body"><p>If you initialise an array within the provided log-likelihood function, e.g. using <code>zeros</code>, then for automatic differentiation methods to work you need to also initialise the type of the array to be based on the type of the input values of θ. Otherwise, zeros will by default create an array with element types <code>Float64</code> which will likely return errors. For example, use:</p><pre><code class="language-julia hljs">my_new_array = zeros(eltype(θ), dimensions)</code></pre><p>where <code>eltype</code> passes the element type of the θ vector into the <code>zeros</code> function.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/model_initialiser.jl#L162-L201">source</a></section><section><div><pre><code class="language-julia hljs">initialise_LikelihoodModel(loglikefunction::Function,
    predictfunction::Function,
    data::Union{Tuple, NamedTuple},
    θnames::Vector{&lt;:Symbol},
    θinitialGuess::Vector{&lt;:Float64},
    θlb::Vector{&lt;:Float64},
    θub::Vector{&lt;:Float64},
    θmagnitudes::Vector{&lt;:Real}=zeros(0);
    &lt;keyword arguments&gt;)</code></pre><p>Alternate version of <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a> that can be called without a error function. The function can be added at a later point using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_error_function!"><code>add_error_function!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/model_initialiser.jl#L297-L309">source</a></section><section><div><pre><code class="language-julia hljs">initialise_LikelihoodModel(loglikefunction::Function,
    data::Union{Tuple, NamedTuple},
    θnames::Vector{&lt;:Symbol},
    θinitialGuess::Vector{&lt;:Float64},
    θlb::Vector{&lt;:Float64},
    θub::Vector{&lt;:Float64},
    θmagnitudes::Vector{&lt;:Real}=zeros(0);
    &lt;keyword arguments&gt;)</code></pre><p>Alternate version of <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a> that can be called without a prediction and error function. The functions can be added at a later point using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_prediction_function!"><code>add_prediction_function!</code></a> and <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_error_function!"><code>add_error_function!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/model_initialiser.jl#L335-L346">source</a></section></article><h2 id="Model-Representation"><a class="docs-heading-anchor" href="#Model-Representation">Model Representation</a><a id="Model-Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Representation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.LikelihoodModel" href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.LikelihoodModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LikelihoodModel(core::Union{CoreLikelihoodModel, BaseLikelihoodModel}, 
    ellipse_MLE_approx::Union{Missing, EllipseMLEApprox},
    num_uni_profiles::Int, 
    num_biv_profiles::Int, 
    num_dim_samples::Int, 
    uni_profiles_df::DataFrame, 
    biv_profiles_df::DataFrame, 
    dim_samples_df::DataFrame, 
    uni_profile_row_exists::Dict{Tuple{Int, AbstractProfileType}, DefaultDict{Float64, Int}},
    biv_profile_row_exists::Dict{Tuple{Tuple{Int, Int}, AbstractProfileType, AbstractBivariateMethod}, DefaultDict{Float64, Int}},
    dim_samples_row_exists::Dict{Union{AbstractSampleType, Tuple{Vector{Int}, AbstractSampleType}}, DefaultDict{Float64, Int}},
    uni_profiles_dict::Dict{Int, UnivariateConfidenceStruct}, 
    biv_profiles_dict::Dict{Int, BivariateConfidenceStruct}, 
    dim_samples_dict::Dict{Int, SampledConfidenceStruct},
    uni_predictions_dict::Dict{Int, AbstractPredictionStruct}, 
    biv_predictions_dict::Dict{Int, AbstractPredictionStruct}, 
    dim_predictions_dict::Dict{Int, AbstractPredictionStruct},
    show_progress::Bool)</code></pre><p>Mutable struct containing all the information required to compute profiles, samples and predictions. Created by <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>core</code>: a <a href="#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a> or <a href="#LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel"><code>BaseLikelihoodModel</code></a> struct.</li><li><code>ellipse_MLE_approx</code>: a <a href="#LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox"><code>EllipseMLEApprox</code></a> struct OR a missing value if the ellipse approximation of the log-likelihood at the MLE point has not been evaluated yet. </li><li><code>num_uni_profiles</code>: the number of different univariate profiles that have been evaluated (distinct combinations of different confidence levels, <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.AbstractProfileType"><code>AbstractProfileType</code></a> structs and single interest parameters). Specifies the number of valid rows in <code>uni_profiles_df</code>.  </li><li><code>num_biv_profiles</code>: the number of different bivariate profiles that have been evaluated (distinct combinations of different confidence levels, <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.AbstractProfileType"><code>AbstractProfileType</code></a> structs, <a href="../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a> structs and two interest parameters). Specifies the number of valid rows in <code>biv_profiles_df</code>.  </li><li><code>num_dim_samples</code>: the number of different dimensional profiles that have been evaluated (distinct combinations of different confidence levels, <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.AbstractProfileType"><code>AbstractProfileType</code></a> structs, <a href="../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.AbstractSampleType"><code>AbstractSampleType</code></a> structs and sets of interest parameters). Specifies the number of valid rows in <code>dim_samples_df</code>.  </li><li><code>uni_profiles_df</code>: a DataFrame with each row containing information on each univariate profile evaluated, where the row index is the key for that profile in <code>uni_profiles_dict</code> and <code>uni_predictions_dict</code>.</li><li><code>biv_profiles_df</code>: a DataFrame with each row containing information on each bivariate profile evaluated, where the row index is the key for that profile in <code>biv_profiles_dict</code> and <code>biv_predictions_dict</code>.</li><li><code>dim_samples_df</code>: a DataFrame with each row containing information on each dimensional sample evaluated, where the row index is the key for that sample in <code>dim_samples_dict</code> and <code>dim_predictions_dict</code>.</li><li><code>uni_profile_row_exists</code>: a dictionary containing information on whether a row in <code>uni_profiles_df</code> exists for a given combination of interest parameter, degrees of freedom, <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.AbstractProfileType"><code>AbstractProfileType</code></a> and confidence level. If it does exist, the value of <code>uni_profile_row_exists[(θi, dof, profile_type)][confidence_level]</code> will be the row index in <code>uni_profiles_df</code>, otherwise it will be <code>0</code>.</li><li><code>biv_profile_row_exists</code>: a dictionary containing information on whether a row in <code>biv_profiles_df</code> exists for a given combination of two interest parameters, <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.AbstractProfileType"><code>AbstractProfileType</code></a>, <a href="../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a> and confidence level. If it does exist, the value of <code>biv_profile_row_exists[((θi, θj), dof, profile_type, bivariate_method)][confidence_level]</code> will be the row index in <code>biv_profiles_df</code> otherwise it will be <code>0</code>.</li><li><code>dim_samples_row_exists</code>: a dictionary containing information on whether a row in <code>dim_samples_df</code> exists for a given combination of interest parameter, <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.AbstractProfileType"><code>AbstractProfileType</code></a>, <a href="../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.AbstractSampleType"><code>AbstractSampleType</code></a> and confidence level. If it does exist, it&#39;s value will be the row index in <code>dim_samples_df</code> otherwise it will be <code>0</code>. For a full likelihood sample this can be accessed using <code>dim_samples_row_exists[sample_type][confidence_level]</code>. For a lower dimensional sample this can be accessed using <code>dim_samples_row_exists[(θindices, dof, sample_type)][confidence_level]</code>.</li><li><code>uni_profiles_dict</code>: a dictionary with keys of type Integer and values of type <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.UnivariateConfidenceStruct"><code>UnivariateConfidenceStruct</code></a> containing the profile for each valid row in <code>uni_profiles_df</code>. The row index of <code>uni_profiles_df</code> is the key for the corresponding profile.</li><li><code>biv_profiles_dict</code>: a dictionary with keys of type Integer and values of type <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.BivariateConfidenceStruct"><code>BivariateConfidenceStruct</code></a> containing the profile for each valid row in <code>biv_profiles_df</code>. The row index of <code>biv_profiles_df</code> is the key for the corresponding profile.</li><li><code>dim_samples_dict</code>: a dictionary with keys of type Integer and values of type <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.SampledConfidenceStruct"><code>SampledConfidenceStruct</code></a> containing the profile for each valid row in <code>dim_samples_df</code>. The row index of <code>dim_samples_df</code> is the key for the corresponding profile.</li><li><code>uni_predictions_dict</code>: a dictionary with keys of type Integer and values of type <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.PredictionStruct"><code>PredictionStruct</code></a> containing the predictions from the profiles in <code>uni_profiles_dict</code> for each valid row in <code>uni_profiles_df</code>. The row index of <code>uni_profiles_df</code> is the key for the corresponding prediction, if that prediction has been calculated using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.generate_predictions_univariate!"><code>generate_predictions_univariate!</code></a>. </li><li><code>biv_predictions_dict</code>: a dictionary with keys of type Integer and values of type <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.PredictionStruct"><code>PredictionStruct</code></a> containing the predictions from the profiles in <code>biv_profiles_dict</code> for each valid row in <code>biv_profiles_df</code>. The row index of <code>biv_profiles_df</code> is the key for the corresponding prediction, if that prediction has been calculated using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.generate_predictions_bivariate!"><code>generate_predictions_bivariate!</code></a>. </li><li><code>dim_predictions_dict</code>: a dictionary with keys of type Integer and values of type <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.PredictionStruct"><code>PredictionStruct</code></a> containing the predictions from the profiles in <code>dim_samples_dict</code> for each valid row in <code>dim_samples_df</code>. The row index of <code>dim_samples_df</code> is the key for the corresponding prediction, if that prediction has been calculated using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.generate_predictions_dim_samples!"><code>generate_predictions_dim_samples!</code></a>. </li><li><code>find_zero_atol</code>: a <code>Real</code> number greater than zero for the absolute tolerance of the log-likelihood function value from the target value to be used when searching for confidence intervals/boundaries.</li><li><code>show_progress</code>: a boolean specifying whether to show the progress of profile methods with respect to sets of interest parameter(s).</li></ul><p><strong>Supertype Hiearachy</strong></p><p><code>LikelihoodModel &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/types/likelihoodmodel.jl#L104-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel" href="#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CoreLikelihoodModel(loglikefunction::Function, 
    predictfunction::Union{Function, Missing}, 
    errorfunction::Union{Function, Missing}
    data::Union{Tuple, NamedTuple}, 
    θnames::AbstractVector
    θname_to_index::Dict{Symbol, Int}, 
    θlb::AbstractVector{&lt;:Real}, 
    θub::AbstractVector{&lt;:Real}, 
    θmagnitudes::AbstractVector{&lt;:Real}, 
    θmle::Vector{&lt;:Float64}, 
    ymle::Array{&lt;:Real}, 
    maximisedmle::Float64, 
    num_pars::Int)</code></pre><p>Struct containing the core information required to define a <a href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a>. For additional information on parameters (where repeated), see <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>loglikefunction</code>: a log-likelihood function which takes two arguments, <code>θ</code> and <code>data</code>, in that order. Set up to be used in a maximisation objective.</li><li><code>predictfunction</code>: a prediction function to generate model predictions from that is paired with the <code>loglikefunction</code>. </li><li><code>errorfunction</code>: an error function used to predict realisations from predictions generated with <code>predictfunction</code>. </li><li><code>optimizationsettings</code>: a <a href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> struct of settings to use for optimisation unless others are specified.</li><li><code>data</code>: a Tuple or a NamedTuple containing any additional information required by the log-likelihood function, such as the time points to be evaluated at.</li><li><code>θnames</code>: a vector of symbols containing the names of each parameter, e.g. <code>[:λ, :K, :C0]</code>.</li><li><code>θname_to_index</code>: a dictionary with keys of type Symbol and values of type Int, with the key being an element of <code>θnames</code> and the value being the corresponding index of the key in <code>θnames</code>.</li><li><code>θlb</code>: a vector of lower bounds on parameters. </li><li><code>θub</code>: a vector of upper bounds on parameters. </li><li><code>θmagnitudes</code>: a vector of the relative magnitude of each parameter. </li><li><code>θmle</code>: a vector containing the maximum likelihood estimate for each parameter.</li><li><code>ymle</code>: an array containing the output of the prediction function at <code>θmle</code> and <code>data</code>.</li><li><code>maximisedmle</code>: the value of the log-likelihood function evaluated at <code>θmle</code>.</li><li><code>num_pars</code>: the number of model parameters, <code>length(θnames)</code>.</li></ul><p><strong>Supertype Hiearachy</strong></p><p><code>CoreLikelihoodModel &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/types/likelihoodmodel.jl#L19-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel" href="#LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BaseLikelihoodModel(data::Union{Tuple, NamedTuple}, 
    θnames::AbstractVector,
    θname_to_index::Dict{Symbol, Int}, 
    θlb::AbstractVector{&lt;:Real}, 
    θub::AbstractVector{&lt;:Real}, 
    θmagnitudes::AbstractVector{&lt;:Real}, 
    θmle::Vector{&lt;:Float64}, 
    ymle::Array{&lt;:Real}, 
    maximisedmle::Float64, 
    num_pars::Int)</code></pre><p>Version of <a href="#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a> without functions, allowing loading of the model struct without those functions defined.</p><p><strong>Supertype Hiearachy</strong></p><p><code>BaseLikelihoodModel &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/types/likelihoodmodel.jl#L73-L90">source</a></section></article><h2 id="Ellipse-Approximation"><a class="docs-heading-anchor" href="#Ellipse-Approximation">Ellipse Approximation</a><a id="Ellipse-Approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Ellipse-Approximation" title="Permalink"></a></h2><p>In order to evaluate the ellipse approximation of the normalised log-likelihood function we need to evaluate the observed Fisher information matrix (FIM) [<a href="../../references/#pawitanall2001">2</a>]. The observed FIM is a quadratic approximation of the curvature of the log-likelihood function at the maximum likelihood estimate (MLE) for parameters. This then allows us to define the ellipse approximation of the log-likelihood function, represented as the <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a> and <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> profile types. These have corresponding equations to evaluate their approximation to the log-likelihood function, as given by <a href="../../internal_library/ellipse_likelihood/#LikelihoodBasedProfileWiseAnalysis.analytic_ellipse_loglike"><code>LikelihoodBasedProfileWiseAnalysis.analytic_ellipse_loglike</code></a> and <a href="../../internal_library/ellipse_likelihood/#LikelihoodBasedProfileWiseAnalysis.ellipse_loglike"><code>LikelihoodBasedProfileWiseAnalysis.ellipse_loglike</code></a>, respectively.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!" href="#LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!"><code>LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getMLE_ellipse_approximation!(model::LikelihoodModel)</code></pre><p>Creates the ellipse approximation of the log-likelihood function at the maximum likelihood estimate, modifying <code>model</code> in place, computing the negative hessian of the log-likelihood function and it&#39;s pseudoinverse using <a href="../../internal_library/ellipse_likelihood/#LikelihoodBasedProfileWiseAnalysis.getMLE_hessian_and_covariance"><code>getMLE_hessian_and_covariance</code></a>. These matrices are stored as a <a href="#LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox"><code>EllipseMLEApprox</code></a> struct within <code>model</code> at <code>model.ellipse_MLE_approx</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/ellipse_likelihood.jl#L139-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_ellipse_approx_exists!" href="#LikelihoodBasedProfileWiseAnalysis.check_ellipse_approx_exists!"><code>LikelihoodBasedProfileWiseAnalysis.check_ellipse_approx_exists!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">check_ellipse_approx_exists!(model::LikelihoodModel)</code></pre><p>Checks if the ellipse approximation at the maximum likelihood estimate has been created and if not creates it using <a href="#LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!"><code>getMLE_ellipse_approximation!</code></a>, modifying <code>model</code> in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/ellipse_likelihood.jl#L155-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox" href="#LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox"><code>LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EllipseMLEApprox(Hmle::Matrix{&lt;:Float64}, Γmle::Matrix{&lt;:Float64})</code></pre><p>Struct containing two n*n arrays representing the ellipse approximation of the log-likelihood function around the MLE point. See <a href="#LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!"><code>getMLE_ellipse_approximation!</code></a></p><p><strong>Fields</strong></p><ul><li><code>Hmle</code>: a n*n array, where n is the number of model parameters, containing the negative Hessian of the log-likelihood function evaluated at the MLE point. </li><li><code>Γmle</code>: a n*n array, where n is the number of model parameters, containing the inverse of <code>Hmle</code>.</li></ul><p><strong>Supertype Hiearachy</strong></p><p><code>EllipseMLEApprox &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/types/likelihoodmodel.jl#L1-L13">source</a></section></article><h2 id="Modifying-Parameter-Magnitudes-and-Bounds"><a class="docs-heading-anchor" href="#Modifying-Parameter-Magnitudes-and-Bounds">Modifying Parameter Magnitudes and Bounds</a><a id="Modifying-Parameter-Magnitudes-and-Bounds-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Parameter-Magnitudes-and-Bounds" title="Permalink"></a></h2><p>If desired, the defined parameter magnitudes and bounds contained with a <a href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> can be updated using <a href="#LikelihoodBasedProfileWiseAnalysis.setmagnitudes!"><code>setmagnitudes!</code></a> and <a href="#LikelihoodBasedProfileWiseAnalysis.setbounds!"><code>setbounds!</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.setmagnitudes!" href="#LikelihoodBasedProfileWiseAnalysis.setmagnitudes!"><code>LikelihoodBasedProfileWiseAnalysis.setmagnitudes!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">setmagnitudes!(model::LikelihoodModel, θmagnitudes::AbstractVector{&lt;:Real})</code></pre><p>Updates the magnitudes of each parameter in <code>model</code> from <code>model.core.θmagnitudes</code> to <code>θmagnitudes</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/common_profile_likelihood.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.setbounds!" href="#LikelihoodBasedProfileWiseAnalysis.setbounds!"><code>LikelihoodBasedProfileWiseAnalysis.setbounds!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">setbounds!(model::LikelihoodModel; 
    lb::AbstractVector{&lt;:Real}=Float64[], 
    ub::AbstractVector{&lt;:Real}=Float64[])</code></pre><p>Updates the parameter bounds in <code>model</code> from <code>model.core.θlb</code> to <code>lb</code> if specified and from <code>model.core.θub</code> to <code>ub</code> if specified. <code>lb</code> and <code>ub</code> are keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/common_profile_likelihood.jl#L41-L47">source</a></section></article><h2 id="Parameter-Transformations"><a class="docs-heading-anchor" href="#Parameter-Transformations">Parameter Transformations</a><a id="Parameter-Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Transformations" title="Permalink"></a></h2><p>To assist with parameter transformations we provide functions for transforming parameter bounds given a monotonic forward mapping from the original parameter space to the transformed parameter space.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.transformbounds" href="#LikelihoodBasedProfileWiseAnalysis.transformbounds"><code>LikelihoodBasedProfileWiseAnalysis.transformbounds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transformbounds(transformfun::Function, 
    lb::AbstractVector{&lt;:Real}, 
    ub::AbstractVector{&lt;:Real}, 
    independentParameterIndexes::Vector{&lt;:Int}=Int[], 
    dependentParameterIndexes::Vector{&lt;:Int}=Int[])</code></pre><p>Given a monotonic (increasing or decreasing) function, <code>transformfun</code>, that describes a parameter transformation, return the lower and upper bounds in the transformed space that correspond to the lower and upper bounds in the original space. Uses a heuristic to evaluate the bound transformation. We assume that the ordering of parameters stay the same for the purposes of <code>independentParameterIndexes</code> and <code>dependentParameterIndexes</code>.</p><p><strong>Arguments</strong></p><ul><li><code>transformfun</code>: a function describing the forward transformation between parameter space <code>θ</code> and <code>Θ</code>. Should take in a single argument, <code>θ</code>, a vector of parameter values in the original space and return <code>Θ</code>, a vector parameter values in the transformed space. These vectors need to be the same length as <code>lb</code> and <code>ub</code>.</li><li><code>lb</code>: a vector of lower bounds on parameters. </li><li><code>ub</code>: a vector of upper bounds on parameters. </li><li><code>independentParameterIndexes</code>: a vector of parameter indexes where the new parameter <code>Θ[i]</code> depends only on <code>transformfun(θ[i])</code>.</li><li><code>dependentParameterIndexes</code>: a vector of parameter indexes where the new parameter <code>Θ[i]</code> depends on <code>transformfun(θ[i], θ[j], j!=i)</code>.</li></ul><p>The heuristic used for dependent parameters may fail if there are multiple local minima for the appropriate bounds to use. In this case <a href="#LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt"><code>transformbounds_NLopt</code></a> should be used.</p><p>Warns if any of the returned bounds are <code>Inf</code> using <a href="../../internal_library/initialisation/#LikelihoodBasedProfileWiseAnalysis.checkforInf"><code>LikelihoodBasedProfileWiseAnalysis.checkforInf</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/transform_bounds.jl#L16-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt" href="#LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt"><code>LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transformbounds_NLopt(transformfun::Function, 
    lb::AbstractVector{&lt;:Real}, 
    ub::AbstractVector{&lt;:Real})</code></pre><p>Given a monotonic (increasing or decreasing) function, <code>transformfun</code>, that describes a parameter transformation, return the lower and upper bounds in the transformed space that correspond to the lower and upper bounds in the original space. Uses a naturally binary integer programme if <code>transformfun</code> is monotonic on θ between <code>lb</code> and <code>ub</code>.</p><p><strong>Arguments</strong></p><ul><li><code>transformfun</code>: a function describing the forward transformation between parameter space <code>θ</code> and <code>Θ</code>. Should take in a single argument, <code>θ</code>, a vector of parameter values in the original space and return <code>Θ</code>, a vector parameter values in the transformed space. These vectors need to be the same length as <code>lb</code> and <code>ub</code>.</li><li><code>lb</code>: a vector of lower bounds on parameters. </li><li><code>ub</code>: a vector of upper bounds on parameters. </li></ul><p>Warns if any of the returned bounds are <code>Inf</code> using <a href="../../internal_library/initialisation/#LikelihoodBasedProfileWiseAnalysis.checkforInf"><code>LikelihoodBasedProfileWiseAnalysis.checkforInf</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/transform_bounds.jl#L102-L115">source</a></section></article><h3 id="Example-Usage"><a class="docs-heading-anchor" href="#Example-Usage">Example Usage</a><a id="Example-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Usage" title="Permalink"></a></h3><p>For example, if we want to log transform the parameterisation given a defined log-likelihood function and lower and upper bounds we:</p><p>Calculate the new, log-transformed bounds using the forward transformation <code>log.(θ)</code>. This is easy enough to be done without <a href="#LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt"><code>transformbounds_NLopt</code></a>, but other more complex transformations may not be.</p><pre><code class="language-julia hljs">lb, ub = ..., ...

f(x) = log.(x)
lb_log, ub_log = transformbounds_NLopt(f, lb, ub)</code></pre><p>Define a new log-likelihood function which uses the backward transformation <code>exp.(θ)</code> from the transformed parameter space to the original space.</p><pre><code class="language-julia hljs">function loglike(θ, data)
    ...
end

function loglike_log(Θ, data)
    return loglike(exp.(Θ), data)
end</code></pre><h2 id="Optimization-Settings"><a class="docs-heading-anchor" href="#Optimization-Settings">Optimization Settings</a><a id="Optimization-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Settings" title="Permalink"></a></h2><p>We can set our default optimisation settings using a <a href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> struct. This will be contained within the <a href="#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a> field of a <a href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> and can be passed as an option to <a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>initialise_LikelihoodModel</code></a>. Unless different ones are passed to functions for computing profiles, they will also be used for that purpose. It may be useful to compute the MLE using conservative settings for accuracy, and then use less conservative settings for the optimisation of nuisance parameters along parameter profiles.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings" href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">default_OptimizationSettings()</code></pre><p>Creates a <a href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> struct with defaults of:</p><ul><li><code>adtype</code>: <code>SciMLBase.NoAD()</code> (no automatic differentiation). </li><li><code>solve_alg</code>: <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/#bobyqa"><code>NLopt.LN_BOBYQA()</code></a>.</li><li><code>solve_kwargs</code>: <code>(maxtime=15, xtol_rel=1e-12)</code>.</li></ul><p>If this function causes an error then <code>LikelihoodBasedProfileWiseAnalysis</code> needs to be loaded. Alternatively, the packages <code>SciMLBase</code>, <code>Optimization</code> and <code>OptimizationNLopt</code> need to be loaded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimizationsettings.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.create_OptimizationSettings" href="#LikelihoodBasedProfileWiseAnalysis.create_OptimizationSettings"><code>LikelihoodBasedProfileWiseAnalysis.create_OptimizationSettings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_OptimizationSettings(model::LikelihoodModel;
    adtype::Union{SciMLBase.AbstractADType, Missing}=missing, 
    solve_alg=missing, 
    solve_kwargs::Union{NamedTuple, Missing}=missing)</code></pre><p>Method for creating a <a href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> struct with each field of the struct as a keyword argument. If a keyword argument is not provided, then the setting in <code>model.core.optimizationsettings</code> is used (the currently set optimization settings).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimizationsettings.jl#L15-L22">source</a></section><section><div><pre><code class="language-julia hljs">create_OptimizationSettings(;
    adtype::Union{SciMLBase.AbstractADType, Missing}=missing, 
    solve_alg=missing, 
    solve_kwargs::Union{NamedTuple, Missing}=missing)</code></pre><p>Method for creating a <a href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> struct with each field of the struct as a keyword argument. If a keyword argument is not provided, then the default setting in <a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a> is used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimizationsettings.jl#L47-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.set_OptimizationSettings!" href="#LikelihoodBasedProfileWiseAnalysis.set_OptimizationSettings!"><code>LikelihoodBasedProfileWiseAnalysis.set_OptimizationSettings!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_OptimizationSettings!(model::LikelihoodModel, optimizationsettings::OptimizationSettings)</code></pre><p>Updates the optimization settings contained with <code>model</code> with <code>optimizationsettings</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimizationsettings.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.OptimizationSettings" href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>LikelihoodBasedProfileWiseAnalysis.OptimizationSettings</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OptimizationSettings(adtype::SciMLBase.AbstractADType,
    solve_alg,
    solve_kwargs::NamedTuple)</code></pre><p>Contains the optimization settings used to solve for nuisance parameters of the log-likelihood function using <a href="https://docs.sciml.ai/Optimization/stable/">Optimization.jl</a>. Note: Optimization.jl uses a minimisation objective, while the log-likelihood functions are setup with a maximisation objective in mind. This is handled inside the package. Defaults can be seen in <a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>adtype</code>: a method for automatically generating derivative functions of the log-likelihood function being optimised. For available settings see <a href="https://docs.sciml.ai/Optimization/stable/API/optimization_function/#Automatic-Differentiation-Construction-Choice-Recommendations">Automatic Differentiation Construction Choice Recommendations</a>. Note: the corresponding package to <code>adtype</code> needs to be loaded with <code>using</code>. e.g. setting <code>adtype = AutoFiniteDiff()</code> requires <code>using FiniteDiff</code>. Derivative-based algorithms in <code>solve_alg</code> will require an <code>adtype</code> to be specified. <ul><li><code>AutoFiniteDiff()</code>, <code>AutoForwardDiff()</code>, <code>AutoReverseDiff()</code>, <code>AutoZygote()</code> and <code>AutoTracker()</code> have been tested to work for finding the maximum likelihood estimate with regular model parameters. </li><li>For profiling, <code>AutoFiniteDiff()</code>, <code>AutoForwardDiff()</code>, <code>AutoReverseDiff()</code> and <code>AutoTracker()</code> have been tested to work with regular model parameters. </li><li>If the variance of the error distribution is included as a parameter to be estimated, <code>AutoFiniteDiff()</code>, <code>AutoForwardDiff()</code> and <code>AutoTracker()</code> have been tested to work for finding the MLE and profiling. </li><li><code>AutoFiniteDiff()</code> will always work, regardless of model specification, but may be less optimal than other methods.</li></ul></li><li><code>solve_alg</code>: an algorithm to use to solve for the nuisance parameters of the log-likelihood function defined within <a href="https://docs.sciml.ai/Optimization/stable/">Optimization.jl</a>. The package is loaded with the Optimization integration of NLopt, so any of the NLopt algorithms are available without having to load another package (see <a href="https://docs.sciml.ai/Optimization/stable/optimization_packages/nlopt/">OptimizationNLopt</a>). Good starting methods may be <code>NLopt.LN_BOBYQA()</code>, <code>NLopt.LN_NELDERMEAD()</code> and <code>NLopt.LD_LBFGS</code>. Other packages can be used as well - see <a href="https://docs.sciml.ai/Optimization/stable/#Overview-of-the-Optimizers">Overview of the Optimizers</a>.</li><li><code>solve_kwargs</code>: a <code>NamedTuple</code> of keyword arguments used to set solver options like <code>maxiters</code> and <code>maxtime</code>. For a list of common solver arguments see: <a href="https://docs.sciml.ai/Optimization/stable/API/solve/#Common-Solver-Options-(Solve-Keyword-Arguments)">Common Solver Options</a>. Other specific package arguments may also be available. For NLopt see <a href="https://docs.sciml.ai/Optimization/stable/optimization_packages/nlopt/#Methods">Methods</a>.</li></ul><p><strong>Supertype Hiearachy</strong></p><p><code>OptimizationSettings &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/types/optimizationsettings.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.optimise" href="#LikelihoodBasedProfileWiseAnalysis.optimise"><code>LikelihoodBasedProfileWiseAnalysis.optimise</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">optimise(fun, q, options::OptimizationSettings, θ₀, lb, ub)</code></pre><p>Optimization.jl optimiser used for calculating the values of nuisance parameters. Default values of options use NLopt.jl algorithms (see<a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimiser.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">optimise(fun, options::OptimizationSettings, θ₀, lb, ub)</code></pre><p>Optimization.jl optimiser used for calculating the bound transformations. Default values of options use NLopt.jl algorithms (see<a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimiser.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.optimise_unbounded" href="#LikelihoodBasedProfileWiseAnalysis.optimise_unbounded"><code>LikelihoodBasedProfileWiseAnalysis.optimise_unbounded</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">optimise_unbounded(fun, q, options::OptimizationSettings, θ₀)</code></pre><p>Alternative version of <a href="#LikelihoodBasedProfileWiseAnalysis.optimise"><code>optimise</code></a> without nuisance parameter bounds. Used for computing the nuisance parameters of <a href="../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a> profiles. Default values of options use NLopt.jl algorithms (see<a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/7f81573d6801c5d18eea389c2c65392414f7c856/src/optimiser.jl#L13-L17">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox"><code>LikelihoodBasedProfileWiseAnalysis.EllipseMLEApprox</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.LikelihoodModel</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>LikelihoodBasedProfileWiseAnalysis.OptimizationSettings</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_ellipse_approx_exists!"><code>LikelihoodBasedProfileWiseAnalysis.check_ellipse_approx_exists!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.create_OptimizationSettings"><code>LikelihoodBasedProfileWiseAnalysis.create_OptimizationSettings</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!"><code>LikelihoodBasedProfileWiseAnalysis.getMLE_ellipse_approximation!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel"><code>LikelihoodBasedProfileWiseAnalysis.initialise_LikelihoodModel</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.optimise"><code>LikelihoodBasedProfileWiseAnalysis.optimise</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.optimise_unbounded"><code>LikelihoodBasedProfileWiseAnalysis.optimise_unbounded</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.set_OptimizationSettings!"><code>LikelihoodBasedProfileWiseAnalysis.set_OptimizationSettings!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.setbounds!"><code>LikelihoodBasedProfileWiseAnalysis.setbounds!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.setmagnitudes!"><code>LikelihoodBasedProfileWiseAnalysis.setmagnitudes!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.transformbounds"><code>LikelihoodBasedProfileWiseAnalysis.transformbounds</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt"><code>LikelihoodBasedProfileWiseAnalysis.transformbounds_NLopt</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../workflow_background/">« Workflow Background</a><a class="docs-footer-nextpage" href="../profiles_and_samples/profile_structs/">Structs and Profile Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 12 February 2024 02:16">Monday 12 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
