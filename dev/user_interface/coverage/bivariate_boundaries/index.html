<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bivariate Parameter Confidence Boundaries · LikelihoodBasedProfileWiseAnalysis.jl</title><meta name="title" content="Bivariate Parameter Confidence Boundaries · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="og:title" content="Bivariate Parameter Confidence Boundaries · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="twitter:title" content="Bivariate Parameter Confidence Boundaries · LikelihoodBasedProfileWiseAnalysis.jl"/><meta name="description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="twitter:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/coverage/bivariate_boundaries/"/><meta property="twitter:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/coverage/bivariate_boundaries/"/><link rel="canonical" href="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/coverage/bivariate_boundaries/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">LikelihoodBasedProfileWiseAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../../workflow_motivation/">Motivation</a></li><li><a class="tocitem" href="../../../workflow_formulation/">Formulation</a></li></ul></li><li><span class="tocitem">User Interface</span><ul><li><a class="tocitem" href="../../initialisation/">Initialisation</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Parameter Profiles and Samples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../profiles_and_samples/profile_structs/">Structs and Profile Types</a></li><li><a class="tocitem" href="../../profiles_and_samples/univariate/">Univariate Profiles</a></li><li><a class="tocitem" href="../../profiles_and_samples/bivariate/">Bivariate Profiles</a></li><li><a class="tocitem" href="../../profiles_and_samples/dimensional/">Dimensional Samples</a></li></ul></li><li><a class="tocitem" href="../../predictions/">Predictions</a></li><li><a class="tocitem" href="../../plots/">Plots</a></li><li><a class="tocitem" href="../../saving_and_loading/">Saving and Loading LikelihoodModels</a></li><li><a class="tocitem" href="../../timing_and_profiling/">Timing and Profiling</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox" checked/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Simulated Coverage Checks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../univariate_intervals/">Parameter Confidence Intervals</a></li><li class="is-active"><a class="tocitem" href>Bivariate Parameter Confidence Boundaries</a><ul class="internal"><li><a class="tocitem" href="#Boundary-Coverage-of-True-Interest-Parameters"><span>Boundary Coverage of True Interest Parameters</span></a></li><li><a class="tocitem" href="#Boundary-Coverage-of-True-Boundary"><span>Boundary Coverage of True Boundary</span></a></li></ul></li><li><a class="tocitem" href="../predictions_and_realisations/">Predictions and Realisations</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/">Distributed Environment Setup</a></li><li><a class="tocitem" href="../../../examples/logistic/">Logistic Model</a></li><li><a class="tocitem" href="../../../examples/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../../../examples/two-species_logistic/">Two-Species Logistic Model</a></li><li><a class="tocitem" href="../../../examples/binomial_normal_approximation/">Gaussian Approximation of a Binomial Distribution</a></li><li><a class="tocitem" href="../../../examples/logistic_timing_estimates/">Function Evaluation Timing - Logistic Model</a></li></ul></li><li><span class="tocitem">Internal Library</span><ul><li><a class="tocitem" href="../../../internal_library/common/">Common Functions</a></li><li><a class="tocitem" href="../../../internal_library/initialisation/">Initialisation Internal</a></li><li><a class="tocitem" href="../../../internal_library/ellipse_likelihood/">Ellipse Functions</a></li><li><a class="tocitem" href="../../../internal_library/univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../../../internal_library/bivariate/">Bivariate Functions</a></li><li><a class="tocitem" href="../../../internal_library/dimensional/">Dimensional Functions</a></li><li><a class="tocitem" href="../../../internal_library/predictions/">Prediction Functions</a></li><li><a class="tocitem" href="../../../internal_library/coverage/">Coverage Functions</a></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Interface</a></li><li><a class="is-disabled">Simulated Coverage Checks</a></li><li class="is-active"><a href>Bivariate Parameter Confidence Boundaries</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bivariate Parameter Confidence Boundaries</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/main/docs/src/user_interface/coverage/bivariate_boundaries.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Bivariate-Parameter-Confidence-Boundaries"><a class="docs-heading-anchor" href="#Bivariate-Parameter-Confidence-Boundaries">Bivariate Parameter Confidence Boundaries</a><a id="Bivariate-Parameter-Confidence-Boundaries-1"></a><a class="docs-heading-anchor-permalink" href="#Bivariate-Parameter-Confidence-Boundaries" title="Permalink"></a></h1><ul><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_boundary_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_boundary_coverage</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_parameter_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_parameter_coverage</code></a></li></ul><p>Usage on several models can be seen in the examples section, such as for the <a href="../../../examples/logistic/#Logistic-Model">Logistic Model</a>.</p><h2 id="Boundary-Coverage-of-True-Interest-Parameters"><a class="docs-heading-anchor" href="#Boundary-Coverage-of-True-Interest-Parameters">Boundary Coverage of True Interest Parameters</a><a id="Boundary-Coverage-of-True-Interest-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Coverage-of-True-Interest-Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_bivariate_parameter_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_parameter_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_parameter_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_bivariate_parameter_coverage(data_generator::Function,
    generator_args::Union{Tuple,NamedTuple},
    model::LikelihoodModel,
    N::Int,
    num_points::Union{Int, Vector{&lt;:Int}},
    θtrue::AbstractVector{&lt;:Real},
    θcombinations::Union{Vector{Vector{Int}}, Vector{Tuple{Int,Int}}},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue; 
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the coverage of bivariate confidence boundaries for two-way sets of interest parameters in <code>θcombinations</code> given a model by: </p><ol><li>Repeatedly drawing new observed data using <code>data_generator</code> for fixed true parameter values, θtrue and fitting the model. </li><li>Testing if each of the true bivariate interest parameters, given nuisance parameters, have log-likelihood values within the confidence threshold. </li><li>If these pass then bivariate confidence boundaries of <code>num_points</code> are found using <code>method</code> and <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.MPPHullMethod"><code>MPPHullMethod</code></a> is used to construct 2D polygon hulls of the boundary points. </li><li>Finally, testing if the boundary polygons contain the true bivariate parameter values in <code>θtrue</code>. The estimated coverage is returned with a default 95% confidence interval within a DataFrame. </li></ol><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. Outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>.</li><li><code>generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>generator_args</code>. </li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information, saved profiles and predictions.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>num_points</code>: positive number of points to find on the boundary at the specified confidence level using a single <code>method</code>. Or a vector of positive numbers of boundary points to find for each method in <code>method</code> (if <code>method</code> is a vector of <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a>). Set to at least 3 within the function as some methods need at least three points to work. </li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θcombinations</code>: a vector of pairs of parameters to profile, as a vector of vectors of model parameter indexes.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to evaluate the confidence interval coverage at. Default is <code>0.95</code> (95%).</li><li><code>profile_type</code>: whether to use the true log-likelihood function or an ellipse approximation of the log-likelihood function centred at the MLE (with optional use of parameter bounds). Available profile types are <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>, <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> and <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a>. Default is <code>LogLikelihood()</code> (<a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>).</li><li><code>method</code>: a method of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a> or a vector of methods of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a> (if so <code>num_points</code> needs to be a vector of the same length). For a list of available methods use <code>bivariate_methods()</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_methods"><code>bivariate_methods</code></a>). Default is <code>RadialRandomMethod(3)</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.RadialRandomMethod"><code>RadialRandomMethod</code></a>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>model.core.optimizationsettings</code>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual bivariate boundary calculations within each iteration (true). Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of bivariate parameter confidence boundaries. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>For a 95% confidence boundary of a pair of interest parameters <code>[θi, θj]</code> it is expected that under repeated experiments from an underlying true model (data generation) which are used to construct a 2D confidence boundary for <code>[θi, θj]</code>, 95% of the true boundaries, would contain the true value <code>[θi, θj]</code>. In the simulation where the values of the true parameters, <code>θtrue</code>, are known, this is equivalent to whether the minimum perimeter polygon of the 2d boundary points for <code>[θi, θj]</code> AND the true confidence boundary contains the value <code>θtrue[[θi, θj]]</code>.</p><p>All of the methods for constructing an approximation of the 2D boundary using <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_confidenceprofiles!"><code>bivariate_confidenceprofiles!</code></a> will approach an exact representation of the 2D 95% confidence boundary, assuming bounds are not in the way, as the number of boundary points approaches infinity. Resultantly, for lower numbers of boundary points the polygon representation of the boundary will be an approximation, with straight edges that do not exactly represent the true boundary. This is why the coverage check also checks if a point is inside the true boundary, as the polygon approximation might be right by accident. This is the same logic [<code>sample_bivariate_internal_points!</code>] uses to find additional internal points within a boundary polygon.</p><p>For estimates of how well the methods approximate the true 2D boundary after turning their boundary points into a polygon hull using a <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateHullMethod"><code>AbstractBivariateHullMethod</code></a>, <a href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_boundary_coverage"><code>check_bivariate_boundary_coverage</code></a> can be used. </p><p>The uncertainty in estimates of the coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Simultaneous bivariate profiles</header><div class="admonition-body"><p>Calculating the coverage of simultaneous bivariate profiles is not currently supported (i.e. for <code>dof ≠ 2</code>)</p></div></div><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few pairs of model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of pairs of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div><div class="admonition is-danger"><header class="admonition-header">May not work correctly on bimodal confidence boundaries</header><div class="admonition-body"><p>The current implementation constructs a single polygon with minimum polygon perimeter from the set of boundary points as the confidence boundary. If there are multiple distinct boundaries represented, then there will be edges connecting the distinct boundaries which the true parameter might be inside (but not inside either of the distinct boundaries). </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/9355cfb00bf64753b8945c2c63f3dc778e6a5c85/src/coverage_checks/parameters/bivariate.jl#L1-L61">source</a></section></article><h2 id="Boundary-Coverage-of-True-Boundary"><a class="docs-heading-anchor" href="#Boundary-Coverage-of-True-Boundary">Boundary Coverage of True Boundary</a><a id="Boundary-Coverage-of-True-Boundary-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Coverage-of-True-Boundary" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_bivariate_boundary_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_boundary_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_boundary_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_bivariate_boundary_coverage(data_generator::Function,
    generator_args::Union{Tuple,NamedTuple},
    model::LikelihoodModel,
    N::Int,
    num_points::Union{Int, Vector{&lt;:Int}},
    num_points_to_sample::Union{Int, Vector{&lt;:Int}},
    θtrue::AbstractVector{&lt;:Real},
    θcombinations::Union{Vector{Vector{Int}}, Vector{Tuple{Int,Int}}},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue; 
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the coverage of approximate bivariate confidence boundaries with <code>num_points</code> constructed using <code>method</code> and <code>hullmethod</code> for two-way sets of interest parameters in <code>θcombinations</code> given a model of the true bivariate confidence boundary by: </p><ol><li>Repeatedly drawing new observed data using <code>data_generator</code> for fixed true parameter values, θtrue and fitting the model. </li><li><code>num_points_to_sample</code> points are then sampled in interest parameter space using <code>sample_type</code> and those that are inside the true bivariate confidence boundary are extracted. </li><li>Then bivariate confidence boundaries of <code>num_points</code> are found using <code>method</code> and <code>hullmethod</code> is used to construct 2D polygon hulls of the boundary points. </li><li>Finally, the percentage of extracted samples that are contained within the 2D polygon hull is extracted. The median and mean percentage (coverage) across all <code>N</code> simulations of the true boundary is recorded and returned with a default 95% simulation quantile interval within a DataFrame. The median may be more reliable for use than the mean due to expected coverage approaching 1.0 when the polygon is a very good representation of the boundary. The 95% simulation quantile interval is the 2.5% and 97.5% quantiles of the coverage across the <code>N simulations</code>. </li></ol><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. Outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>.</li><li><code>generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>generator_args</code>. </li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information, saved profiles and predictions.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>num_points</code>: positive number of points to find on the boundary at the specified confidence level using a single <code>method</code>. Or a vector of positive numbers of boundary points to find for each method in <code>method</code> (if <code>method</code> is a vector of <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a>). Set to at least 3 within the function as some methods need at least three points to work. </li><li><code>num_points_to_sample</code>: integer number of points to sample (for <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> sample types) from interest parameter space. For the <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a> sample type, if integer it is the number of points to grid over in each parameter dimension. If it is a vector of integers each index of the vector is the number of points to grid over in the corresponding parameter dimension. For example, [1,2] would mean a single point in dimension 1 and two points in dimension 2. </li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θcombinations</code>: a vector of pairs of parameters to profile, as a vector of vectors of model parameter indexes.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to evaluate the confidence interval coverage at. Default is <code>0.95</code> (95%).</li><li><code>profile_type</code>: whether to use the true log-likelihood function or an ellipse approximation of the log-likelihood function centred at the MLE (with optional use of parameter bounds). Available profile types are <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>, <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> and <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a>. Default is <code>LogLikelihood()</code> (<a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>).</li><li><code>method</code>: a method of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a> or a vector of methods of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a> (if so <code>num_points</code> needs to be a vector of the same length). For a list of available methods use <code>bivariate_methods()</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_methods"><code>bivariate_methods</code></a>). Default is <code>RadialRandomMethod(3)</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.RadialRandomMethod"><code>RadialRandomMethod</code></a>).</li><li><code>sample_type</code>: the sampling method used to sample parameter space of type [<code>AbstractSampleType</code>]. Default is <code>LatinHypercubeSamples()</code> (<a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>hullmethod</code>: method of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateHullMethod"><code>AbstractBivariateHullMethod</code></a> used to create a 2D polygon hull that approximates the bivariate boundary from a set of boundary points and internal points (method dependent) (or vector of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateHullMethod"><code>AbstractBivariateHullMethod</code></a> if comparison between hull methods is1 desired). For available methods see <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_hull_methods"><code>bivariate_hull_methods()</code></a>. Default is <code>MPPHullMethod()</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.MPPHullMethod"><code>MPPHullMethod</code></a>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>coverage_estimate_quantile_level</code>: a number ∈ (0.0, 1.0) for the level of the quantile interval of the estimated coverage (intervals are formed from simulation quantiles). Default is <code>0.95</code> (95%).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual bivariate boundary calculations within each iteration (true). Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of the approximations of the true bivariate parameter confidence boundaries. Namely, how well the approximation contains the true boundary. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>Tests how well the boundary polygon created by a <code>method</code> with a given number of points and turned into a polygon hull using <code>hullmethod</code> contains the theoretical boundary by testing how many samples from a <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.AbstractSampleType"><code>AbstractSampleType</code></a> within the true boundary are within the boundary polygon.</p><p>If <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.MPPHullMethod"><code>MPPHullMethod</code></a> is the <code>hullmethod</code> used, it is expected that the approximation of the true bivariate parameter confidence boundary created by <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_confidenceprofiles!"><code>bivariate_confidenceprofiles!</code></a> will be an exact representation, as the number of boundary points approaches infinity. For <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.ConcaveHullMethod"><code>ConcaveHullMethod</code></a> this is also likely to be the case, but it may fail due to being a heuristic. For <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.ConvexHullMethod"><code>ConvexHullMethod</code></a> this will be true if the true boundary is convex. If the true boundary is concave then the approximation that uses <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.ConvexHullMethod"><code>ConvexHullMethod</code></a> will fully contain the true boundary, but will also contain parameter space that is not part of the true boundary. </p><p>This check is useful for determining how to most efficiently sample internal points from bivariate confidence boundaries with [<code>sample_bivariate_internal_points</code>] as it shows how the interaction between the <code>method</code>, <code>hullmethod</code> and the number of boundary points impact the coverage of the true boundary. For example, using <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.ConvexHullMethod"><code>ConvexHullMethod</code></a> will generally give the highest coverage of the true boundary, but may cause the rejection rate to be higher because it contains a greater area that is not part of the true boundary.</p><p>The uncertainty in estimates of the coverage under the simulated model will become more accurate as the number of simulations, <code>N</code>, is increased. Simulation quantile intervals for the coverage estimate are provided to quantify this uncertainty. </p><div class="admonition is-info"><header class="admonition-header">Simultaneous bivariate profiles</header><div class="admonition-body"><p>Calculating the coverage for approximations of simultaneous bivariate profiles is not currently supported (i.e. for <code>dof ≠ 2</code>)</p></div></div><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few pairs of model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of pairs of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/9355cfb00bf64753b8945c2c63f3dc778e6a5c85/src/coverage_checks/parameters/bivariate_boundary.jl#L1-L63">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../univariate_intervals/">« Parameter Confidence Intervals</a><a class="docs-footer-nextpage" href="../predictions_and_realisations/">Predictions and Realisations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 28 October 2024 02:20">Monday 28 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
