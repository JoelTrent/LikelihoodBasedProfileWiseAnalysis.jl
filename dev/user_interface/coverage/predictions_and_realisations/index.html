<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Predictions and Realisations · LikelihoodBasedProfileWiseAnalysis.jl</title><meta name="title" content="Predictions and Realisations · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="og:title" content="Predictions and Realisations · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="twitter:title" content="Predictions and Realisations · LikelihoodBasedProfileWiseAnalysis.jl"/><meta name="description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="twitter:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/coverage/predictions_and_realisations/"/><meta property="twitter:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/coverage/predictions_and_realisations/"/><link rel="canonical" href="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/coverage/predictions_and_realisations/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">LikelihoodBasedProfileWiseAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../../workflow_motivation/">Motivation</a></li><li><a class="tocitem" href="../../../workflow_formulation/">Formulation</a></li></ul></li><li><span class="tocitem">User Interface</span><ul><li><a class="tocitem" href="../../initialisation/">Initialisation</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Parameter Profiles and Samples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../profiles_and_samples/profile_structs/">Structs and Profile Types</a></li><li><a class="tocitem" href="../../profiles_and_samples/univariate/">Univariate Profiles</a></li><li><a class="tocitem" href="../../profiles_and_samples/bivariate/">Bivariate Profiles</a></li><li><a class="tocitem" href="../../profiles_and_samples/dimensional/">Dimensional Samples</a></li></ul></li><li><a class="tocitem" href="../../predictions/">Predictions</a></li><li><a class="tocitem" href="../../plots/">Plots</a></li><li><a class="tocitem" href="../../saving_and_loading/">Saving and Loading LikelihoodModels</a></li><li><a class="tocitem" href="../../timing_and_profiling/">Timing and Profiling</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox" checked/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Simulated Coverage Checks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../univariate_intervals/">Parameter Confidence Intervals</a></li><li><a class="tocitem" href="../bivariate_boundaries/">Bivariate Parameter Confidence Boundaries</a></li><li class="is-active"><a class="tocitem" href>Predictions and Realisations</a><ul class="internal"><li><a class="tocitem" href="#Predictions"><span>Predictions</span></a></li><li><a class="tocitem" href="#Realisations"><span>Realisations</span></a></li></ul></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/">Distributed Environment Setup</a></li><li><a class="tocitem" href="../../../examples/logistic/">Logistic Model</a></li><li><a class="tocitem" href="../../../examples/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../../../examples/two-species_logistic/">Two-Species Logistic Model</a></li><li><a class="tocitem" href="../../../examples/binomial_normal_approximation/">Gaussian Approximation of a Binomial Distribution</a></li><li><a class="tocitem" href="../../../examples/logistic_timing_estimates/">Function Evaluation Timing - Logistic Model</a></li></ul></li><li><span class="tocitem">Internal Library</span><ul><li><a class="tocitem" href="../../../internal_library/common/">Common Functions</a></li><li><a class="tocitem" href="../../../internal_library/initialisation/">Initialisation Internal</a></li><li><a class="tocitem" href="../../../internal_library/ellipse_likelihood/">Ellipse Functions</a></li><li><a class="tocitem" href="../../../internal_library/univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../../../internal_library/bivariate/">Bivariate Functions</a></li><li><a class="tocitem" href="../../../internal_library/dimensional/">Dimensional Functions</a></li><li><a class="tocitem" href="../../../internal_library/predictions/">Prediction Functions</a></li><li><a class="tocitem" href="../../../internal_library/coverage/">Coverage Functions</a></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Interface</a></li><li><a class="is-disabled">Simulated Coverage Checks</a></li><li class="is-active"><a href>Predictions and Realisations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Predictions and Realisations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/main/docs/src/user_interface/coverage/predictions_and_realisations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Predictions-and-Realisations"><a class="docs-heading-anchor" href="#Predictions-and-Realisations">Predictions and Realisations</a><a id="Predictions-and-Realisations-1"></a><a class="docs-heading-anchor-permalink" href="#Predictions-and-Realisations" title="Permalink"></a></h1><ul><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_coverage</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_realisations_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_realisations_coverage</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_coverage</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_realisations_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_realisations_coverage</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_coverage</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_realisations_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_realisations_coverage</code></a></li></ul><p>Usage on several models can be seen in the examples section, such as for the <a href="../../../examples/logistic/#Logistic-Model">Logistic Model</a>.</p><h2 id="Predictions"><a class="docs-heading-anchor" href="#Predictions">Predictions</a><a id="Predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Predictions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_dimensional_prediction_coverage(data_generator::Function, 
    generator_args::Union{Tuple, NamedTuple},
    t::AbstractVector,
    model::LikelihoodModel, 
    N::Int, 
    num_points_to_sample::Union{Int, Vector{&lt;:Int}},
    θtrue::AbstractVector{&lt;:Real}, 
    θindices::Union{Vector{Vector{Int}}, Vector{Vector{Symbol}}},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue;
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the prediction coverage of dimensional confidence samples (including full likelihood samples) for parameters in <code>θindices</code> given a model by: </p><ol><li>Repeatedly drawing new observed data using <code>data_generator</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Fitting the model. </li><li>Sampling points using <code>sample_type</code>.</li><li>Evaluating predictions from the points in the samples and finding the prediction extrema.</li><li>Checking whether the prediction extrema contain the true prediction value(s), in a pointwise and simultaneous fashion. The estimated simultaneous coverage is returned with a default 95% confidence interval within a DataFrame. </li></ol><p>The prediction coverage from combining the prediction sets of multiple confidence profiles, choosing 1 to <code>length(θindices)</code> random combinations of <code>θindices</code>, is also evaluated (i.e. the final result is the union over all profiles in <code>θindices</code>). </p><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. Outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>.</li><li><code>generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>generator_args</code>. </li><li><code>t</code>: a vector of time points to compute predictions and evaluate coverage at.</li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>num_points_to_sample</code>: integer number of points to sample (for <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> sample types). For the <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a> sample type, if integer it is the number of points to grid over in each parameter dimension. If it is a vector of integers each index of the vector is the number of points to grid over in the corresponding parameter dimension. For example, [1,2] would mean a single point in dimension 1 and two points in dimension 2. </li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θindices</code>: a vector of vectors of parameter indexes for the combinations of interest parameters to samples points from.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to find samples within and evaluate coverage at. Default is <code>0.95</code> (95%).</li><li><code>sample_type</code>: the sampling method used to sample parameter space. Available sample types are <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a>, <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>. Default is <code>LatinHypercubeSamples()</code> (<a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>lb</code>: optional vector of lower bounds on parameters. Use to specify parameter lower bounds to sample over that are different than those contained in <code>model.core</code>. Default is <code>Float64[]</code> (use lower bounds from <code>model.core</code>).</li><li><code>ub</code>: optional vector of upper bounds on parameters. Use to specify parameter upper bounds to sample over that are different than those contained in <code>model.core</code>. Default is <code>Float64[]</code> (use upper bounds from <code>model.core</code>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual confidence profile calculations within each iteration (true). Default is <code>false</code>.</li><li><code>manual_GC_calls</code>: boolean variable specifying whether to manually call garbage collection, <code>GC.gc()</code>, after every 10 iterations (<code>distributed_over_parameters=true</code>) or after every iteration on that worker (<code>distributed_over_parameters=false</code>). May be important to correctly free up memory for coverage simulations that use distributed or threaded workloads for Julia versions prior to v1.10.0. Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of propagating dimensional samples into prediction space. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>The uncertainty in estimates of the prediction coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Support for `dof`</header><div class="admonition-body"><p>Setting the degrees of freedom of a sampled parameter confidence set to a value other than the interest parameter dimensionality is not currently supported (e.g. as supported for univariate and bivariate profiles). Support may be added in the future.</p></div></div><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few pairs of model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of pairs of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/77e340e9a287c0246f6048d9da56a0616bf0c126/src/coverage_checks/predictions/dimensional.jl#L1-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_univariate_prediction_coverage(data_generator::Function, 
    generator_args::Union{Tuple, NamedTuple},
    model::LikelihoodModel, 
    N::Int, 
    θtrue::AbstractVector{&lt;:Real}, 
    θs::AbstractVector{&lt;:Int64},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue; 
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the prediction coverage of univariate confidence profiles for parameters in <code>θs</code> given a model by: </p><ol><li>Repeatedly drawing new observed data using <code>data_generator</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Fitting the model and univariate confidence intervals. </li><li>Sampling points along the profile within the confidence intervals.</li><li>Evaluating predictions from the points in the profile and finding the prediction extrema.</li><li>Checking whether the prediction extrema contain the true prediction value(s), in a pointwise and simultaneous fashion. The estimated simultaneous coverage is returned with a default 95% confidence interval within a DataFrame. </li></ol><p>The prediction coverage from combining the prediction sets of multiple confidence profiles, choosing 1 to <code>length(θs)</code> random combinations of <code>θs</code>, is also evaluated (i.e. the final result is the union over all profiles in <code>θs</code>). </p><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. Outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>.</li><li><code>generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>generator_args</code>. </li><li><code>t</code>: a vector of time points to compute predictions and evaluate coverage at.</li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θs</code>: a vector of parameters to profile, as a vector of model parameter indexes.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>num_points_in_interval</code>: an integer number of points to optionally evaluate within the confidence interval for each interest parameter using <a href="../../profiles_and_samples/univariate/#LikelihoodBasedProfileWiseAnalysis.get_points_in_intervals!"><code>get_points_in_intervals!</code></a>. Points are linearly spaced in the interval. Useful for predictions from univariate profiles. Default is <code>0</code>. </li><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to evaluate the confidence interval coverage at. Default is <code>0.95</code> (95%).</li><li><code>dof</code>: an integer ∈ [1, <code>model.core.num_pars</code>] for the degrees of freedom used to define the asymptotic threshold (<a href="../../../internal_library/common/#LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood"><code>LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood</code></a>) which defines the extremities of the univariate profile, i.e. the confidence interval. For parameter confidence intervals that are considered individually, it should be set to <code>1</code>. For intervals that are considered simultaneously, it should be set to the number of intervals that are being calculated, i.e. <code>model.core.num_pars</code> when we wish the confidence interval for every parameter to hold simultaneously. Default is <code>1</code>. Setting it to <code>model.core.num_pars</code> should be reasonable when making predictions for well-identified models with <code>&lt;10</code> parameters. Note: values other than <code>1</code> and <code>model.core.num_pars</code> may not have a clear statistical interpretation.</li><li><code>profile_type</code>: whether to use the true log-likelihood function or an ellipse approximation of the log-likelihood function centred at the MLE (with optional use of parameter bounds). Available profile types are <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>, <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> and <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a>. Default is <code>LogLikelihood()</code> (<a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual confidence interval calculations within each iteration (true). Default is <code>false</code>.</li><li><code>manual_GC_calls</code>: boolean variable specifying whether to manually call garbage collection, <code>GC.gc()</code>, after every 10 iterations (<code>distributed_over_parameters=true</code>) or after every iteration on that worker (<code>distributed_over_parameters=false</code>). May be important to correctly free up memory for coverage simulations that use distributed or threaded workloads for Julia versions prior to v1.10.0.  Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of propagating univariate parameter confidence intervals into prediction space. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>The uncertainty in estimates of the prediction coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div><div class="admonition is-danger"><header class="admonition-header">Not intended for use on bimodal univariate profile likelihoods</header><div class="admonition-body"><p>The current implementation only considers two extremes of the log-likelihood and whether the truth is between these two points. If the profile likelihood function is bimodal, it&#39;s possible the method has only found one set of correct confidence intervals (estimated coverage will be correct, but less than expected) or found one extrema on distinct sets (estimated coverage may be incorrect and will either be larger than expected or much lower than expected). </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/77e340e9a287c0246f6048d9da56a0616bf0c126/src/coverage_checks/predictions/univariate.jl#L1-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_bivariate_prediction_coverage(data_generator::Function, 
    generator_args::Union{Tuple, NamedTuple},
    t::AbstractVector,
    model::LikelihoodModel, 
    N::Int, 
    num_points::Union{Int, Vector{&lt;:Int}},
    θtrue::AbstractVector{&lt;:Real}, 
    θcombinations::Union{Vector{Vector{Int}}, Vector{Tuple{Int,Int}}},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue; 
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the prediction coverage of bivariate confidence profiles for parameters in <code>θcombinations</code> given a model by: </p><ol><li>Repeatedly drawing new observed data using <code>data_generator</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Fitting the model and bivariate confidence boundaries. </li><li>Sampling points within the polygon hull of the confidence boundaries.</li><li>Evaluating predictions from the points in the profile and finding the prediction extrema.</li><li>Checking whether the prediction extrema contain the true prediction value(s), in a pointwise and simultaneous fashion. The estimated simultaneous coverage is returned with a default 95% confidence interval within a DataFrame. </li></ol><p>The prediction coverage from combining the prediction sets of multiple confidence profiles, choosing 1 to <code>length(θcombinations)</code> random combinations of <code>θcombinations</code>, is also evaluated (i.e. the final result is the union over all profiles in <code>θcombinations</code>). </p><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. Outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>.</li><li><code>generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>generator_args</code>. </li><li><code>t</code>: a vector of time points to compute predictions and evaluate coverage at.</li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>num_points</code>: positive number of points to find on the boundary at the specified confidence level using a single <code>method</code>. Or a vector of positive numbers of boundary points to find for each method in <code>method</code> (if <code>method</code> is a vector of <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a>). Set to at least 3 within the function as some methods need at least three points to work. </li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θcombinations</code>: a vector of pairs of parameters to profile, as a vector of vectors of model parameter indexes.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>num_internal_points</code>: an integer number of points to optionally evaluate within the a polygon hull approximation of a bivariate boundary for each interest parameter pair using <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.sample_bivariate_internal_points!"><code>sample_bivariate_internal_points!</code></a>. Default is <code>0</code>. </li><li><code>hullmethod</code>: method of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateHullMethod"><code>AbstractBivariateHullMethod</code></a> used to create a 2D polygon hull that approximates the bivariate boundary from a set of boundary points and internal points (method dependent). For available methods see <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_hull_methods"><code>bivariate_hull_methods()</code></a>. Default is <code>MPPHullMethod()</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.MPPHullMethod"><code>MPPHullMethod</code></a>).</li><li><code>sample_type</code>: either a <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> or <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> struct for how to sample internal points from the polygon hull. <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> are homogeneously sampled from the polygon and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> use the intersection of a heuristically optimised Latin Hypercube sampling plan with the polygon. Default is <code>LatinHypercubeSamples()</code> (<a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level on which to find the <code>profile_type</code> boundary. Default is <code>0.95</code> (95%).</li><li><code>dof</code>: an integer ∈ [2, <code>model.core.num_pars</code>] for the degrees of freedom used to define the asymptotic threshold (<a href="../../../internal_library/common/#LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood"><code>LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood</code></a>) which defines the boundary of the bivariate profile. For bivariate profiles that are considered individually, it should be set to <code>2</code>. For profiles that are considered simultaneously, it should be set to <code>model.core.num_pars</code>. Default is <code>2</code>. Setting it to <code>model.core.num_pars</code> should be reasonable when making predictions for well-identified models with <code>&lt;10</code> parameters. Note: values other than <code>2</code> and <code>model.core.num_pars</code> may not have a clear statistical interpretation.</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>profile_type</code>: whether to use the true log-likelihood function or an ellipse approximation of the log-likelihood function centred at the MLE (with optional use of parameter bounds). Available profile types are <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>, <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> and <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a>. Default is <code>LogLikelihood()</code> (<a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>).</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual confidence interval calculations within each iteration (true). Default is <code>false</code>.</li><li><code>manual_GC_calls</code>: boolean variable specifying whether to manually call garbage collection, <code>GC.gc()</code>, after every 10 iterations (<code>distributed_over_parameters=true</code>) or after every iteration on that worker (<code>distributed_over_parameters=false</code>). May be important to correctly free up memory for coverage simulations that use distributed or threaded workloads for Julia versions prior to v1.10.0.  Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of propagating bivariate parameter confidence intervals into prediction space. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>The uncertainty in estimates of the prediction coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few pairs of model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of pairs of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div><div class="admonition is-danger"><header class="admonition-header">May not work correctly on bimodal confidence boundaries</header><div class="admonition-body"><p>The current implementation constructs a single polygon with minimum polygon perimeter from the set of boundary points as the confidence boundary. If there are multiple distinct boundaries represented, then there will be edges connecting the distinct boundaries which the true parameter might be inside (but not inside either of the distinct boundaries). </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/77e340e9a287c0246f6048d9da56a0616bf0c126/src/coverage_checks/predictions/bivariate.jl#L1-L63">source</a></section></article><h2 id="Realisations"><a class="docs-heading-anchor" href="#Realisations">Realisations</a><a id="Realisations-1"></a><a class="docs-heading-anchor-permalink" href="#Realisations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_realisations_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_realisations_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_dimensional_prediction_realisations_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_dimensional_prediction_realisations_coverage(data_generator::Function,
    reference_set_generator::Function,
    training_generator_args::Union{Tuple,NamedTuple},
    testing_generator_args::Union{Tuple,NamedTuple},
    t::AbstractVector,
    model::LikelihoodModel, 
    N::Int, 
    num_points_to_sample::Union{Int, Vector{&lt;:Int}},
    θtrue::AbstractVector{&lt;:Real}, 
    θindices::Union{Vector{Vector{Int}}, Vector{Vector{Symbol}}},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue;
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the prediction reference set and realisation coverage of dimensional confidence samples (including full likelihood samples) for parameters in <code>θindices</code> given a model by: </p><ol><li>Constructing the <code>confidence_level</code> reference set for predictions from the fixed true parameter values, <code>θ_true</code>.</li><li>Repeatedly drawing new observed training data using <code>data_generator</code> and <code>training_generator_args</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Fitting the model using training data.</li><li>Sampling points using <code>sample_type</code>.</li><li>Evaluating predictions from the points in the samples and finding the prediction extrema (reference tolerance sets).</li><li>Drawing new observed testing data using <code>data_generator</code> and <code>training_generator_args</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Checking whether the prediction extrema (reference tolerance set) contains the prediction reference set from Step 1, in a pointwise and simultaneous fashion. </li><li>Checking whether the prediction extrema contain the observed testing data, in a pointwise and simultaneous fashion. </li><li>The estimated simultaneous coverage of the reference set and the prediction realisations (observed testing data) is returned with a default 95% confidence interval, alongside pointwise coverage, within a DataFrame. We also provided an alternate &#39;simultaneous&#39; statistic for prediction realisation coverage; rather than testing whether 100% of prediction realisations are covered we test whether <code>simultaneous_alternate_proportion</code> proportion of prediction realisations are covered. </li></ol><p>The prediction coverage from combining the prediction sets of multiple confidence profiles, choosing 1 to <code>length(θindices)</code> random combinations of <code>θindices</code>, is also evaluated (i.e. the final result is the union over all profiles in <code>θindices</code>). </p><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. When used with <code>training_generator_args</code>, it outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>. When used with <code>testing_generator_args</code>, it outputs an array containing the observed data to use as the test data set.</li><li><code>reference_set_generator</code>: a function with three arguments which generates the <code>confidence_level</code> data reference set for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The three arguments must be the vector of true model parameters, <code>θtrue</code>, a Tuple or NamedTuple, <code>generator_args</code>, and a number (0.0, 1.0) for the confidence level at which to evaluate the reference set. When used with <code>testing_generator_args</code> it outputs a tuple of two arrays, <code>(lq, uq)</code>, which contain the lower and upper quantiles of the reference set. </li><li><code>training_generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at, used to create the training set of data. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>training_generator_args</code>. </li><li><code>testing_generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at, used to create the test data set. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>testing_generator_args</code>. </li><li><code>t</code>: a vector of time points to compute predictions and evaluate coverage at, which are the same as the time points used to create the test data set.</li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>num_points_to_sample</code>: integer number of points to sample (for <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> sample types). For the <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a> sample type, if integer it is the number of points to grid over in each parameter dimension. If it is a vector of integers each index of the vector is the number of points to grid over in the corresponding parameter dimension. For example, [1,2] would mean a single point in dimension 1 and two points in dimension 2. </li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θindices</code>: a vector of vectors of parameter indexes for the combinations of interest parameters to samples points from.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to find samples within and evaluate coverage at. Default is <code>0.95</code> (95%).</li><li><code>region</code>: a <code>Real</code> number ∈ [0, 1] specifying the proportion of the density of the error model from which to evaluate the highest density region. Default is <code>0.95</code>.</li><li><code>sample_type</code>: the sampling method used to sample parameter space. Available sample types are <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a>, <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>. Default is <code>LatinHypercubeSamples()</code> (<a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>lb</code>: optional vector of lower bounds on parameters. Use to specify parameter lower bounds to sample over that are different than those contained in <code>model.core</code>. Default is <code>Float64[]</code> (use lower bounds from <code>model.core</code>).</li><li><code>ub</code>: optional vector of upper bounds on parameters. Use to specify parameter upper bounds to sample over that are different than those contained in <code>model.core</code>. Default is <code>Float64[]</code> (use upper bounds from <code>model.core</code>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>simultaneous_alternate_proportion</code>: a number ∈ (0.0, 1.0) for the alternate &#39;simultaneous&#39; coverage statistic, testing whether at least this proportion of prediction realisations are covered. Recommended to be equal to <code>region</code>. Default is <code>0.95</code> (95%). </li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual confidence profile calculations within each iteration (true). Default is <code>false</code>.</li><li><code>manual_GC_calls</code>: boolean variable specifying whether to manually call garbage collection, <code>GC.gc()</code>, after every 10 iterations (<code>distributed_over_parameters=true</code>) or after every iteration on that worker (<code>distributed_over_parameters=false</code>). May be important to correctly free up memory for coverage simulations that use distributed or threaded workloads for Julia versions prior to v1.10.0. Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of propagating dimensional samples into prediction realisation space. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>The uncertainty in estimates of the prediction realisation coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Support for `dof`</header><div class="admonition-body"><p>Setting the degrees of freedom of a sampled parameter confidence set to a value other than the interest parameter dimensionality is not currently supported (e.g. as supported for univariate and bivariate profiles). Support may be added in the future.</p></div></div><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few pairs of model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of pairs of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/77e340e9a287c0246f6048d9da56a0616bf0c126/src/coverage_checks/predictions/dimensional.jl#L239-L308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_realisations_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_realisations_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_univariate_prediction_realisations_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_univariate_prediction_realisations_coverage(data_generator::Function, 
    training_generator_args::Union{Tuple, NamedTuple},
    testing_generator_args::Union{Tuple, NamedTuple},
    model::LikelihoodModel, 
    N::Int, 
    θtrue::AbstractVector{&lt;:Real}, 
    θs::AbstractVector{&lt;:Int64},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue; 
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the prediction reference set and realisation coverage of univariate confidence profiles for parameters in <code>θs</code> given a model by: </p><ol><li>Constructing the <code>confidence_level</code> reference set for predictions from the fixed true parameter values, <code>θ_true</code>.</li><li>Repeatedly drawing new observed training data using <code>data_generator</code> and <code>training_generator_args</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Fitting the model using training data.</li><li>Fitting the model and univariate confidence intervals using training data. </li><li>Sampling points along the profile within the confidence intervals.</li><li>Evaluating predictions from the points in the profile and finding the prediction extrema (reference tolerance sets).</li><li>Drawing new observed testing data using <code>data_generator</code> and <code>training_generator_args</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Checking whether the prediction extrema (reference tolerance set) contains the prediction reference set from Step 1, in a pointwise and simultaneous fashion. </li><li>Checking whether the prediction extrema contain the observed testing data, in a pointwise and simultaneous fashion. </li><li>The estimated simultaneous coverage of the reference set and the prediction realisations (observed testing data) is returned with a default 95% confidence interval, alongside pointwise coverage, within a DataFrame. We also provided an alternate &#39;simultaneous&#39; statistic for prediction realisation coverage; rather than testing whether 100% of prediction realisations are covered we test whether <code>simultaneous_alternate_proportion</code> proportion of prediction realisations are covered. </li></ol><p>The coverage from combining the prediction reference sets of multiple confidence profiles, choosing 1 to <code>length(θs)</code> random combinations of <code>θs</code>, is also evaluated (i.e. the final result is the union over all profiles in <code>θs</code>). </p><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. When used with <code>training_generator_args</code>, it outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>. When used with <code>testing_generator_args</code>, it outputs an array containing the observed data to use as the test data set.</li><li><code>reference_set_generator</code>: a function with three arguments which generates the <code>confidence_level</code> data reference set for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The three arguments must be the vector of true model parameters, <code>θtrue</code>, a Tuple or NamedTuple, <code>generator_args</code>, and a number (0.0, 1.0) for the confidence level at which to evaluate the reference set. When used with <code>testing_generator_args</code> it outputs a tuple of two arrays, <code>(lq, uq)</code>, which contain the lower and upper quantiles of the reference set. </li><li><code>training_generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at, used to create the training set of data. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>training_generator_args</code>. </li><li><code>testing_generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at, used to create the test data set. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>testing_generator_args</code>. </li><li><code>t</code>: a vector of time points to compute predictions and evaluate coverage at, which are the same as the time points used to create the test data set.</li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θs</code>: a vector of parameters to profile, as a vector of model parameter indexes.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>num_points_in_interval</code>: an integer number of points to optionally evaluate within the confidence interval for each interest parameter using <a href="../../profiles_and_samples/univariate/#LikelihoodBasedProfileWiseAnalysis.get_points_in_intervals!"><code>get_points_in_intervals!</code></a>. Points are linearly spaced in the interval. Useful for predictions from univariate profiles. Default is <code>0</code>. </li><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to evaluate the confidence interval coverage at. Default is <code>0.95</code> (95%).</li><li><code>dof</code>: an integer ∈ [1, <code>model.core.num_pars</code>] for the degrees of freedom used to define the asymptotic threshold (<a href="../../../internal_library/common/#LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood"><code>LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood</code></a>) which defines the extremities of the univariate profile, i.e. the confidence interval. For parameter confidence intervals that are considered individually, it should be set to <code>1</code>. For intervals that are considered simultaneously, it should be set to the number of intervals that are being calculated, i.e. <code>model.core.num_pars</code> when we wish the confidence interval for every parameter to hold simultaneously. Default is <code>1</code>. Setting it to <code>model.core.num_pars</code> should be reasonable when making predictions for well-identified models with <code>&lt;10</code> parameters. Note: values other than <code>1</code> and <code>model.core.num_pars</code> may not have a clear statistical interpretation.</li><li><code>region</code>: a <code>Real</code> number ∈ [0, 1] specifying the proportion of the density of the error model from which to evaluate the highest density region. Default is <code>0.95</code>.</li><li><code>profile_type</code>: whether to use the true log-likelihood function or an ellipse approximation of the log-likelihood function centred at the MLE (with optional use of parameter bounds). Available profile types are <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>, <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> and <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a>. Default is <code>LogLikelihood()</code> (<a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>simultaneous_alternate_proportion</code>: a number ∈ (0.0, 1.0) for the alternate &#39;simultaneous&#39; coverage statistic, testing whether at least this proportion of prediction realisations are covered. Recommended to be equal to <code>region</code>. Default is <code>0.95</code> (95%).</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual confidence interval calculations within each iteration (true). Default is <code>false</code>.</li><li><code>manual_GC_calls</code>: boolean variable specifying whether to manually call garbage collection, <code>GC.gc()</code>, after every 10 iterations (<code>distributed_over_parameters=true</code>) or after every iteration on that worker (<code>distributed_over_parameters=false</code>). May be important to correctly free up memory for coverage simulations that use distributed or threaded workloads for Julia versions prior to v1.10.0. Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of propagating univariate parameter confidence intervals into prediction realisation space. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>The uncertainty in estimates of the prediction realisation coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div><div class="admonition is-danger"><header class="admonition-header">Not intended for use on bimodal univariate profile likelihoods</header><div class="admonition-body"><p>The current implementation only considers two extremes of the log-likelihood and whether the truth is between these two points. If the profile likelihood function is bimodal, it&#39;s possible the method has only found one set of correct confidence intervals (estimated coverage will be correct, but less than expected) or found one extrema on distinct sets (estimated coverage may be incorrect and will either be larger than expected or much lower than expected). </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/77e340e9a287c0246f6048d9da56a0616bf0c126/src/coverage_checks/predictions/univariate.jl#L235-L301">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_realisations_coverage" href="#LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_realisations_coverage"><code>LikelihoodBasedProfileWiseAnalysis.check_bivariate_prediction_realisations_coverage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_bivariate_prediction_realisations_coverage(data_generator::Function, 
    reference_set_generator::Function,
    training_generator_args::Union{Tuple, NamedTuple},
    testing_generator_args::Union{Tuple, NamedTuple},
    t::AbstractVector,
    model::LikelihoodModel, 
    N::Int, 
    num_points::Union{Int, Vector{&lt;:Int}},
    θtrue::AbstractVector{&lt;:Real}, 
    θcombinations::Union{Vector{Vector{Int}}, Vector{Tuple{Int,Int}}},
    θinitialguess::AbstractVector{&lt;:Real}=θtrue; 
    &lt;keyword arguments&gt;)</code></pre><p>Performs a simulation to estimate the prediction reference set and realisation coverage of bivariate confidence profiles for parameters in <code>θcombinations</code> given a model by:</p><ol><li>Constructing the <code>confidence_level</code> reference set for predictions from the fixed true parameter values, <code>θ_true</code>.</li><li>Repeatedly drawing new observed training data using <code>data_generator</code> and <code>training_generator_args</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Fitting the model using training data.</li><li>Fitting the model and bivariate confidence boundaries using training data. </li><li>Sampling points within the polygon hull of the confidence boundaries.</li><li>Evaluating predictions from the points in the profile and finding the prediction extrema (reference tolerance sets).</li><li>Drawing new observed testing data using <code>data_generator</code> and <code>training_generator_args</code> for fixed true parameter values, <code>θtrue</code>, and fixed true prediction value. </li><li>Checking whether the prediction extrema (reference tolerance set) contains the prediction reference set from Step 1, in a pointwise and simultaneous fashion. </li><li>Checking whether the prediction extrema contain the observed testing data, in a pointwise and simultaneous fashion. </li><li>The estimated simultaneous coverage of the reference set and the prediction realisations (observed testing data) is returned with a default 95% confidence interval, alongside pointwise coverage, within a DataFrame. We also provided an alternate &#39;simultaneous&#39; statistic for prediction realisation coverage; rather than testing whether 100% of prediction realisations are covered we test whether <code>simultaneous_alternate_proportion</code> proportion of prediction realisations are covered. </li></ol><p>The prediction coverage from combining the prediction reference sets of multiple confidence profiles, choosing 1 to <code>length(θcombinations)</code> random combinations of <code>θcombinations</code>, is also evaluated (i.e. the final result is the union over all profiles in <code>θcombinations</code>). </p><p><strong>Arguments</strong></p><ul><li><code>data_generator</code>: a function with two arguments which generates data for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The two arguments must be the vector of true model parameters, <code>θtrue</code>, and a Tuple or NamedTuple, <code>generator_args</code>. When used with <code>training_generator_args</code>, it outputs a <code>data</code> Tuple or NamedTuple that corresponds to the log-likelihood function contained in <code>model</code>. When used with <code>testing_generator_args</code>, it outputs an array containing the observed data to use as the test data set.</li><li><code>reference_set_generator</code>: a function with three arguments which generates the <code>confidence_level</code> data reference set for fixed time points and true model parameters corresponding to the log-likelihood function contained in <code>model</code>. The three arguments must be the vector of true model parameters, <code>θtrue</code>, a Tuple or NamedTuple, <code>generator_args</code>, and a number (0.0, 1.0) for the confidence level at which to evaluate the reference set. When used with <code>testing_generator_args</code> it outputs a tuple of two arrays, <code>(lq, uq)</code>, which contain the lower and upper quantiles of the reference set. </li><li><code>training_generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at, used to create the training set of data. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>training_generator_args</code>. </li><li><code>testing_generator_args</code>: a Tuple or NamedTuple containing any additional information required by both the log-likelihood function and <code>data_generator</code>, such as the time points to be evaluated at, used to create the test data set. If evaluating the log-likelihood function requires more than just the simulated data, arguments for the <code>data</code> output of <code>data_generator</code> should be passed in via <code>testing_generator_args</code>. </li><li><code>t</code>: a vector of time points to compute predictions and evaluate coverage at, which are the same as the time points used to create the test data set.</li><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information.</li><li><code>N</code>: a positive number of coverage simulations.</li><li><code>num_points</code>: positive number of points to find on the boundary at the specified confidence level using a single <code>method</code>. Or a vector of positive numbers of boundary points to find for each method in <code>method</code> (if <code>method</code> is a vector of <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateMethod"><code>AbstractBivariateMethod</code></a>). Set to at least 3 within the function as some methods need at least three points to work. </li><li><code>θtrue</code>: a vector of true parameters values of the model for simulating data with. </li><li><code>θcombinations</code>: a vector of pairs of parameters to profile, as a vector of vectors of model parameter indexes.</li><li><code>θinitialguess</code>: a vector containing the initial guess for the values of each parameter. Used to find the MLE point in each iteration of the simulation. Default is <code>θtrue</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>num_internal_points</code>: an integer number of points to optionally evaluate within the a polygon hull approximation of a bivariate boundary for each interest parameter pair using <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.sample_bivariate_internal_points!"><code>sample_bivariate_internal_points!</code></a>. Default is <code>0</code>. </li><li><code>hullmethod</code>: method of type <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.AbstractBivariateHullMethod"><code>AbstractBivariateHullMethod</code></a> used to create a 2D polygon hull that approximates the bivariate boundary from a set of boundary points and internal points (method dependent). For available methods see <a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.bivariate_hull_methods"><code>bivariate_hull_methods()</code></a>. Default is <code>MPPHullMethod()</code> (<a href="../../profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.MPPHullMethod"><code>MPPHullMethod</code></a>).</li><li><code>sample_type</code>: either a <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> or <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> struct for how to sample internal points from the polygon hull. <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> are homogeneously sampled from the polygon and <a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> use the intersection of a heuristically optimised Latin Hypercube sampling plan with the polygon. Default is <code>LatinHypercubeSamples()</code> (<a href="../../profiles_and_samples/dimensional/#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level on which to find the <code>profile_type</code> boundary. Default is <code>0.95</code> (95%).</li><li><code>dof</code>: an integer ∈ [2, <code>model.core.num_pars</code>] for the degrees of freedom used to define the asymptotic threshold (<a href="../../../internal_library/common/#LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood"><code>LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood</code></a>) which defines the boundary of the bivariate profile. For bivariate profiles that are considered individually, it should be set to <code>2</code>. For profiles that are considered simultaneously, it should be set to <code>model.core.num_pars</code>. Default is <code>2</code>. Setting it to <code>model.core.num_pars</code> should be reasonable when making predictions for well-identified models with <code>&lt;10</code> parameters. Note: values other than <code>2</code> and <code>model.core.num_pars</code> may not have a clear statistical interpretation.</li><li><code>region</code>: a <code>Real</code> number ∈ [0, 1] specifying the proportion of the density of the error model from which to evaluate the highest density region. Default is <code>0.95</code>.</li><li><code>profile_type</code>: whether to use the true log-likelihood function or an ellipse approximation of the log-likelihood function centred at the MLE (with optional use of parameter bounds). Available profile types are <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>, <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApprox"><code>EllipseApprox</code></a> and <a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.EllipseApproxAnalytical"><code>EllipseApproxAnalytical</code></a>. Default is <code>LogLikelihood()</code> (<a href="../../profiles_and_samples/profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>coverage_estimate_confidence_level</code>: a number ∈ (0.0, 1.0) for the level of a confidence interval of the estimated coverage. Default is <code>0.95</code> (95%).</li><li><code>simultaneous_alternate_proportion</code>: a number ∈ (0.0, 1.0) for the alternate &#39;simultaneous&#39; coverage statistic, testing whether at least this proportion of prediction realisations are covered. Recommended to be equal to <code>region</code>. Default is <code>0.95</code> (95%).</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter value. Default is <code>missing</code> (will use <code>default_OptimizationSettings()</code> (see <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of simulation iterations completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>distributed_over_parameters</code>: boolean variable specifying whether to distribute the workload of the simulation across simulation iterations (false) or across the individual confidence interval calculations within each iteration (true). Default is <code>false</code>.</li><li><code>manual_GC_calls</code>: boolean variable specifying whether to manually call garbage collection, <code>GC.gc()</code>, after every 10 iterations (<code>distributed_over_parameters=true</code>) or after every iteration on that worker (<code>distributed_over_parameters=false</code>). May be important to correctly free up memory for coverage simulations that use distributed or threaded workloads for Julia versions prior to v1.10.0.  Default is <code>false</code>.</li></ul><p><strong>Details</strong></p><p>This simulated coverage check is used to estimate the performance of propagating bivariate parameter confidence intervals into prediction realisation space. The simulation uses <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> to parallelise the workload.</p><p>The uncertainty in estimates of the prediction realisation coverage under the simulated model will decrease as the number of simulations, <code>N</code>, is increased. Confidence intervals for the coverage estimate are provided to quantify this uncertainty. The confidence interval for the estimated coverage is a Clopper-Pearson interval on a binomial test generated using <a href="https://juliastats.org/HypothesisTests.jl/stable/">HypothesisTests.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Recommended setting for distributed_over_parameters</header><div class="admonition-body"><ul><li>If the number of processes available to use is significantly greater than the number of model parameters or only a few pairs of model parameters are being checked for coverage, <code>false</code> is recommended.   </li><li>If system memory or model size in system memory is a concern, or the number of processes available is similar or less than the number of pairs of model parameters being checked, <code>true</code> will likely be more appropriate. </li><li>When set to <code>false</code>, a separate <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> struct will be used by each process, as opposed to only one when set to <code>true</code>, which could cause a memory issue for larger models. </li></ul></div></div><div class="admonition is-danger"><header class="admonition-header">May not work correctly on bimodal confidence boundaries</header><div class="admonition-body"><p>The current implementation constructs a single polygon with minimum polygon perimeter from the set of boundary points as the confidence boundary. If there are multiple distinct boundaries represented, then there will be edges connecting the distinct boundaries which the true parameter might be inside (but not inside either of the distinct boundaries). </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/77e340e9a287c0246f6048d9da56a0616bf0c126/src/coverage_checks/predictions/bivariate.jl#L292-L364">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bivariate_boundaries/">« Bivariate Parameter Confidence Boundaries</a><a class="docs-footer-nextpage" href="../../../examples/">Distributed Environment Setup »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 28 October 2024 04:46">Monday 28 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
