<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Saving and Loading LikelihoodModels · LikelihoodBasedProfileWiseAnalysis.jl</title><meta name="title" content="Saving and Loading LikelihoodModels · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="og:title" content="Saving and Loading LikelihoodModels · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="twitter:title" content="Saving and Loading LikelihoodModels · LikelihoodBasedProfileWiseAnalysis.jl"/><meta name="description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="twitter:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/saving_and_loading/"/><meta property="twitter:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/saving_and_loading/"/><link rel="canonical" href="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/saving_and_loading/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LikelihoodBasedProfileWiseAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick Start</a></li><li><span class="tocitem">User Interface</span><ul><li><a class="tocitem" href="../initialisation/">Initialisation</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Parameter Profiles and Samples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../profiles_and_samples/profile_structs/">Structs and Profile Types</a></li><li><a class="tocitem" href="../profiles_and_samples/univariate/">Univariate Profiles</a></li><li><a class="tocitem" href="../profiles_and_samples/bivariate/">Bivariate Profiles</a></li><li><a class="tocitem" href="../profiles_and_samples/dimensional/">Dimensional Samples</a></li></ul></li><li><a class="tocitem" href="../predictions/">Predictions</a></li><li><a class="tocitem" href="../plots/">Plots</a></li><li class="is-active"><a class="tocitem" href>Saving and Loading LikelihoodModels</a><ul class="internal"><li><a class="tocitem" href="#Potential-Issues-When-Loading"><span>Potential Issues When Loading</span></a></li><li><a class="tocitem" href="#Fixing-Issues"><span>Fixing Issues</span></a></li><li><a class="tocitem" href="#Saving-and-Loading-Functions"><span>Saving and Loading Functions</span></a></li></ul></li><li><a class="tocitem" href="../timing_and_profiling/">Timing and Profiling</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Simulated Coverage Checks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../coverage/univariate_intervals/">Parameter Confidence Intervals</a></li><li><a class="tocitem" href="../coverage/bivariate_boundaries/">Bivariate Parameter Confidence Boundaries</a></li><li><a class="tocitem" href="../coverage/predictions_and_realisations/">Predictions and Realisations</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/">Initial Setup</a></li><li><a class="tocitem" href="../../examples/logistic/">Logistic Model</a></li><li><a class="tocitem" href="../../examples/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../../examples/two-species_logistic/">Two-Species Logistic Model</a></li><li><a class="tocitem" href="../../examples/binomial_normal_approximation/">Gaussian Approximation of a Binomial Distribution</a></li><li><a class="tocitem" href="../../examples/logistic_timing_estimates/">Function Evaluation Timing - Logistic Model</a></li></ul></li><li><span class="tocitem">Internal Library</span><ul><li><a class="tocitem" href="../../internal_library/common/">Common Functions</a></li><li><a class="tocitem" href="../../internal_library/initialisation/">Initialisation</a></li><li><a class="tocitem" href="../../internal_library/ellipse_likelihood/">Ellipse Functions</a></li><li><a class="tocitem" href="../../internal_library/univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../../internal_library/bivariate/">Bivariate Functions</a></li><li><a class="tocitem" href="../../internal_library/dimensional/">Dimensional Functions</a></li><li><a class="tocitem" href="../../internal_library/predictions/">Prediction Functions</a></li><li><a class="tocitem" href="../../internal_library/plots/">Plotting Functions</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Interface</a></li><li class="is-active"><a href>Saving and Loading LikelihoodModels</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Saving and Loading LikelihoodModels</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/main/docs/src/user_interface/saving_and_loading.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Saving-and-Loading-LikelihoodModels"><a class="docs-heading-anchor" href="#Saving-and-Loading-LikelihoodModels">Saving and Loading LikelihoodModels</a><a id="Saving-and-Loading-LikelihoodModels-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-and-Loading-LikelihoodModels" title="Permalink"></a></h1><p>Models can be saved easily using <a href="https://github.com/JuliaIO/BSON.jl/tree/master">BSON.jl</a> as they are defined using a Julia struct. </p><p>The only thing to be careful of is ensuring that empty dataframe rows within the model are removed prior to saving using <a href="#LikelihoodBasedProfileWiseAnalysis.trim_model_dfs!"><code>trim_model_dfs!</code></a> (as they include undefined references). </p><pre><code class="language-julia hljs">using LikelihoodBasedProfileWiseAnalysis

# function definitions and initialisation...
model = 
trim_model_dfs!(model)
using BSON: @save

@save &quot;mymodel.bson&quot; model</code></pre><p>To load <code>model</code> in a new session/file:</p><pre><code class="language-julia hljs">using LikelihoodBasedProfileWiseAnalysis
using BSON: @load

# function definitions....

@load &quot;mymodel.bson&quot; model</code></pre><h2 id="Potential-Issues-When-Loading"><a class="docs-heading-anchor" href="#Potential-Issues-When-Loading">Potential Issues When Loading</a><a id="Potential-Issues-When-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-Issues-When-Loading" title="Permalink"></a></h2><p>There are a couple of things to watch out for if the model saved had functions defined in <code>model.core</code>:</p><ul><li>The log-likelihood function (and if defined, the prediction and error functions) must be defined with the same name and be available in the scope we are loading <code>model</code> in. Functions used within <code>model.core.optimizationsettings</code> must also be defined in the scope we are loading <code>model</code> in (i.e. by loading <code>LikelihoodBasedProfileWiseAnalysis</code>).</li><li>The variable name <code>model</code> has when saved is the same name it needs to be loaded with.</li></ul><h2 id="Fixing-Issues"><a class="docs-heading-anchor" href="#Fixing-Issues">Fixing Issues</a><a id="Fixing-Issues-1"></a><a class="docs-heading-anchor-permalink" href="#Fixing-Issues" title="Permalink"></a></h2><p>The first of these issues we can get around by converting our <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a> to a <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel"><code>BaseLikelihoodModel</code></a> before saving. The only difference between these two structs is that <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel"><code>BaseLikelihoodModel</code></a> doesn&#39;t contain fields for the log-likelihood, prediction and error functions. This means we can load a saved <code>model</code> without needing those functions defined in the local scope, which may be useful for workflows where the computation is performed in one file and plotting of outputs is performed in another file.</p><p>We can use <a href="#LikelihoodBasedProfileWiseAnalysis.remove_functions_from_core!"><code>remove_functions_from_core!</code></a> to perform this task, pulling out the original <code>model.core</code> so we can put it back into <code>model</code> later if desired: </p><pre><code class="language-julia hljs">core_original = remove_functions_from_core!(model)
@save &quot;mymodel.bson&quot; model

# restore the core that has the functions if desired
model.core = core_original </code></pre><p>If we want to add the log-likelihood function to this loaded version of the <code>model</code> we can use <a href="#LikelihoodBasedProfileWiseAnalysis.add_loglikelihood_function!"><code>add_loglikelihood_function!</code></a> after loading <code>LikelihoodBasedProfileWiseAnalysis</code>.</p><pre><code class="language-julia hljs">using LikelihoodBasedProfileWiseAnalysis
# log-likelihood function function definition
function loglikefunction(θ, data); return ... end
add_loglikelihood_function!(model, loglikefunction)</code></pre><div class="admonition is-danger"><header class="admonition-header">Missing log-likelihood function</header><div class="admonition-body"><p>Trying to use a profile-related function will result in an error if the log-likelihood function is not defined in <code>model.core</code>.</p></div></div><p>The prediction function can be added in the same fashion using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_prediction_function!"><code>add_prediction_function!</code></a>. However, the log-likelihood function must have been added first.</p><p>The error function can also be added in the same fashion using <a href="../predictions/#LikelihoodBasedProfileWiseAnalysis.add_error_function!"><code>add_error_function!</code></a>. However, the log-likelihood must have been added first.</p><h2 id="Saving-and-Loading-Functions"><a class="docs-heading-anchor" href="#Saving-and-Loading-Functions">Saving and Loading Functions</a><a id="Saving-and-Loading-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-and-Loading-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.trim_model_dfs!" href="#LikelihoodBasedProfileWiseAnalysis.trim_model_dfs!"><code>LikelihoodBasedProfileWiseAnalysis.trim_model_dfs!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">trim_model_dfs!(model::LikelihoodModel)</code></pre><p>Removes any unitialised rows of <code>model.uni_profiles_df</code>, model.biv<em>profiles</em>df and model.dim<em>samples</em>df in place, which contain undefined references and will prevent saving using <a href="https://github.com/JuliaIO/BSON.jl/tree/master">BSON.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/12b67f7641085d3165c6c4dd53191fa2d230700f/src/loading.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.remove_functions_from_core!" href="#LikelihoodBasedProfileWiseAnalysis.remove_functions_from_core!"><code>LikelihoodBasedProfileWiseAnalysis.remove_functions_from_core!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_functions_from_core!(model::LikelihoodModel)</code></pre><p>Removes the functions from <code>model.core</code> by replacing the <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a> at <code>model.core</code> with a <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.BaseLikelihoodModel"><code>BaseLikelihoodModel</code></a>, returning the <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/12b67f7641085d3165c6c4dd53191fa2d230700f/src/loading.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.add_loglikelihood_function!" href="#LikelihoodBasedProfileWiseAnalysis.add_loglikelihood_function!"><code>LikelihoodBasedProfileWiseAnalysis.add_loglikelihood_function!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">add_loglikelihood_function!(model::LikelihoodModel, loglikefunction::Function; 
    optimizationsettings::OptimizationSettings=default_OptimizationSettings())</code></pre><p>Adds a log-likelihood function, <code>loglikefunction</code>, to <code>model</code> as well as optimization settings, <code>optimizationsettings</code>, using <a href="../initialisation/#LikelihoodBasedProfileWiseAnalysis.default_OptimizationSettings"><code>default_OptimizationSettings</code></a>.</p><p>Requirements for <code>loglikefunction</code>: loglikelihood function which takes two arguments, <code>θ</code> and <code>data</code>, in that order, where θ is a vector containing the values of each parameter in <code>θnames</code> and <code>data</code> is a Tuple or NamedTuple containing any additional information required by the log-likelihood function, such as the time points to be evaluated at.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/12b67f7641085d3165c6c4dd53191fa2d230700f/src/loading.jl#L32-L39">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../plots/">« Plots</a><a class="docs-footer-nextpage" href="../timing_and_profiling/">Timing and Profiling »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 2 February 2024 04:36">Friday 2 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
