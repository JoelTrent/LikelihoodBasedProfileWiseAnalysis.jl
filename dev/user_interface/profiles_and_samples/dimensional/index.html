<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dimensional Samples · LikelihoodBasedProfileWiseAnalysis.jl</title><meta name="title" content="Dimensional Samples · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="og:title" content="Dimensional Samples · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="twitter:title" content="Dimensional Samples · LikelihoodBasedProfileWiseAnalysis.jl"/><meta name="description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="twitter:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/profiles_and_samples/dimensional/"/><meta property="twitter:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/profiles_and_samples/dimensional/"/><link rel="canonical" href="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/user_interface/profiles_and_samples/dimensional/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">LikelihoodBasedProfileWiseAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../../workflow_motivation/">Motivation</a></li><li><a class="tocitem" href="../../../workflow_formulation/">Formulation</a></li></ul></li><li><span class="tocitem">User Interface</span><ul><li><a class="tocitem" href="../../initialisation/">Initialisation</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Parameter Profiles and Samples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../profile_structs/">Structs and Profile Types</a></li><li><a class="tocitem" href="../univariate/">Univariate Profiles</a></li><li><a class="tocitem" href="../bivariate/">Bivariate Profiles</a></li><li class="is-active"><a class="tocitem" href>Dimensional Samples</a><ul class="internal"><li><a class="tocitem" href="#Sample-Types"><span>Sample Types</span></a></li><li><a class="tocitem" href="#Full-Likelihood-Sampling"><span>Full Likelihood Sampling</span></a></li><li><a class="tocitem" href="#Dimensional-Likelihood-Sampling"><span>Dimensional Likelihood Sampling</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../predictions/">Predictions</a></li><li><a class="tocitem" href="../../plots/">Plots</a></li><li><a class="tocitem" href="../../saving_and_loading/">Saving and Loading LikelihoodModels</a></li><li><a class="tocitem" href="../../timing_and_profiling/">Timing and Profiling</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Simulated Coverage Checks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../coverage/univariate_intervals/">Parameter Confidence Intervals</a></li><li><a class="tocitem" href="../../coverage/bivariate_boundaries/">Bivariate Parameter Confidence Boundaries</a></li><li><a class="tocitem" href="../../coverage/predictions_and_realisations/">Predictions and Realisations</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/">Distributed Environment Setup</a></li><li><a class="tocitem" href="../../../examples/logistic/">Logistic Model</a></li><li><a class="tocitem" href="../../../examples/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../../../examples/two-species_logistic/">Two-Species Logistic Model</a></li><li><a class="tocitem" href="../../../examples/binomial_normal_approximation/">Gaussian Approximation of a Binomial Distribution</a></li><li><a class="tocitem" href="../../../examples/logistic_timing_estimates/">Function Evaluation Timing - Logistic Model</a></li></ul></li><li><span class="tocitem">Internal Library</span><ul><li><a class="tocitem" href="../../../internal_library/common/">Common Functions</a></li><li><a class="tocitem" href="../../../internal_library/initialisation/">Initialisation Internal</a></li><li><a class="tocitem" href="../../../internal_library/ellipse_likelihood/">Ellipse Functions</a></li><li><a class="tocitem" href="../../../internal_library/univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../../../internal_library/bivariate/">Bivariate Functions</a></li><li><a class="tocitem" href="../../../internal_library/dimensional/">Dimensional Functions</a></li><li><a class="tocitem" href="../../../internal_library/predictions/">Prediction Functions</a></li><li><a class="tocitem" href="../../../internal_library/coverage/">Coverage Functions</a></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Interface</a></li><li><a class="is-disabled">Parameter Profiles and Samples</a></li><li class="is-active"><a href>Dimensional Samples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dimensional Samples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/main/docs/src/user_interface/profiles_and_samples/dimensional.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dimensional-Samples"><a class="docs-heading-anchor" href="#Dimensional-Samples">Dimensional Samples</a><a id="Dimensional-Samples-1"></a><a class="docs-heading-anchor-permalink" href="#Dimensional-Samples" title="Permalink"></a></h1><p>We can generate samples within the log-likelihood boundary at any dimension of model interest parameters. Nuisance parameters will be set to the values that maximise the log-likelihood function, found using an optimisation scheme. Samples are only implemented for the true log-likelihood function (the <a href="../profile_structs/#LikelihoodBasedProfileWiseAnalysis.LogLikelihood"><code>LogLikelihood</code></a> profile type).</p><h2 id="Sample-Types"><a class="docs-heading-anchor" href="#Sample-Types">Sample Types</a><a id="Sample-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Sample-Types" title="Permalink"></a></h2><p>Three methods are implemented for rejection sampling of parameter confidence sets within the supplied parameter bounds. These will be inefficient if the bounds are not well-specified (are not close to the boundary of the desired parameter confidence set), and as both the model parameter dimension increases and the interest parameter dimension of the profile increases. By default these are the bounds contained with <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.CoreLikelihoodModel"><code>CoreLikelihoodModel</code></a>, however, seperate bounds can be supplied for the purposes of sampling. Uniform grid sampling, uniform random sampling and sampling from a random Latin Hypercube scheme (the default) are supported.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.AbstractSampleType" href="#LikelihoodBasedProfileWiseAnalysis.AbstractSampleType"><code>LikelihoodBasedProfileWiseAnalysis.AbstractSampleType</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSampleType</code></pre><p>Supertype for sample types.</p><p><strong>Subtypes</strong></p><p><a href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a></p><p><a href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a></p><p><a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/types/sampletypes.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.UniformGridSamples" href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>LikelihoodBasedProfileWiseAnalysis.UniformGridSamples</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UniformGridSamples()</code></pre><p>Evaluate the interest parameter bounds space on a uniform grid, determining the optimised log-likelihood value at each grid point. Keep samples which are inside the confidence threshold boundary. </p><p><strong>Supertype Hiearachy</strong></p><p><code>UniformGridSamples &lt;: AbstractSampleType &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/types/sampletypes.jl#L16-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples" href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UniformRandomSamples()</code></pre><p>Take uniform random samples of interest parameter bounds space, determining the optimised log-likelihood value at each point. Keep samples which are inside the confidence threshold boundary. </p><p><strong>Supertype Hiearachy</strong></p><p><code>UniformRandomSamples &lt;: AbstractSampleType &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/types/sampletypes.jl#L27-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples" href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LatinHypercubeSamples()</code></pre><p>Create a Latin Hypercube sampling plan in interest parameter bounds space, determining the optimised log-likelihood value at each point in the plan. Keep samples which are inside the confidence threshold boundary. Uses <a href="https://github.com/MrUrq/LatinHypercubeSampling.jl">LatinHypercubeSampling.jl</a>.</p><p><strong>Supertype Hiearachy</strong></p><p><code>LatinHypercubeSamples &lt;: AbstractSampleType &lt;: Any</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/types/sampletypes.jl#L38-L46">source</a></section></article><h2 id="Full-Likelihood-Sampling"><a class="docs-heading-anchor" href="#Full-Likelihood-Sampling">Full Likelihood Sampling</a><a id="Full-Likelihood-Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Likelihood-Sampling" title="Permalink"></a></h2><p>To sample a confidence set for the full parameter vector, a full parameter confidence set, we use <a href="#LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample!"><code>full_likelihood_sample!</code></a>. The sampled confidence set will be contained within a <a href="../profile_structs/#LikelihoodBasedProfileWiseAnalysis.SampledConfidenceStruct"><code>SampledConfidenceStruct</code></a> that is stored in the <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample!" href="#LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample!"><code>LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">full_likelihood_sample!(model::LikelihoodModel,
    num_points_to_sample::Union{Int, Vector{Int}};
    &lt;keyword arguments&gt;)</code></pre><p>Samples <code>num_points_to_sample</code> points from full parameter space, evaluating the log-likelihood function at each, saving all points that are inside the <code>confidence_level</code> log-likelihood threshold. Saves this sample by modifying <code>model</code> in place.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information, saved profiles and predictions.</li><li><code>num_points_to_sample</code>: integer number of points to sample (for <a href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> sample types). For the <a href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a> sample type, if integer it is the number of points to grid over in each parameter dimension. If it is a vector of integers each index of the vector is the number of points to grid over in the corresponding parameter dimension. For example, [1,2] would mean a single point in dimension 1 and two points in dimension 2. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level which . Default is <code>0.95</code> (95%).</li><li><code>sample_type</code>: the sampling method used to sample parameter space. Available sample types are <a href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a>, <a href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>. Default is <code>LatinHypercubeSamples()</code> (<a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>lb</code>: optional vector of lower bounds on parameters. Use to specify parameter lower bounds to sample over that are different than those contained in <code>model.core</code>. Default is <code>Float64[]</code> (use lower bounds from <code>model.core</code>).</li><li><code>ub</code>: optional vector of upper bounds on parameters. Use to specify parameter upper bounds to sample over that are different than those contained in <code>model.core</code>. Default is <code>Float64[]</code> (use upper bounds from <code>model.core</code>).</li><li><code>existing_profiles</code>: <code>Symbol ∈ [:ignore, :overwrite]</code> specifying what to do if samples already exist for a given <code>confidence_level</code> and <code>sample_type</code>.  Default is <code>:overwrite</code>.</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of <code>θcombinations</code> completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>use_distributed</code>: boolean variable specifying whether to use a threaded for loop or distributed for loop to evaluate the log-likelihood at each sampled point. This should be set to true if Julia instances have been started with low numbers of threads or distributed computing is being used. Default is <code>false</code>.</li><li><code>use_threads</code>: boolean variable specifying, if <code>use_distributed</code> is false, whether to use a parallelised for loop across <code>Threads.nthreads()</code> threads or a non-parallel for loop to evaluate the log-likelihood at each sampled point. Default is true.</li></ul><p><strong>Details</strong></p><p>Using <a href="../../../internal_library/dimensional/#LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample"><code>full_likelihood_sample</code></a> this function calls the sample method specified by <code>sample_type</code> (depending on the setting for <code>existing_profiles</code> and <code>confidence_level</code> if a full likelihood sample already exists). Updates <code>model.dim_samples_df</code> if the sample is successful and saves the results as a <a href="../profile_structs/#LikelihoodBasedProfileWiseAnalysis.SampledConfidenceStruct"><code>SampledConfidenceStruct</code></a> in <code>model.dim_samples_dict</code>, where the keys for the dictionary is the row number in <code>model.dim_samples_df</code> of the corresponding sample.</p><p><strong>Extended help</strong></p><p><strong>Parallel Computing Implementation</strong></p><p>If <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> is being used and <code>use_distributed</code> is <code>true</code>,the log-likelihood value of sampled points will be computed in parallel across <code>Distributed.nworkers()</code> workers. If <code>use_distributed</code> is <code>false</code> and <code>use_threads</code> is <code>true</code> then the log-likelihood value of sampled points will be computed in parallel across <code>Threads.nthreads()</code> threads.</p><p><strong>Iteration Speed Of the Progress Meter</strong></p><p>The time/it value is the time it takes for each point chosen under the specified sampling scheme to be evaluated as valid or not. A point is valid if the log-likelihood function value at that point is greater than the confidence log-likelihood threshold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/dimensional_methods/full_likelihood_sampling.jl#L308-L342">source</a></section></article><h2 id="Dimensional-Likelihood-Sampling"><a class="docs-heading-anchor" href="#Dimensional-Likelihood-Sampling">Dimensional Likelihood Sampling</a><a id="Dimensional-Likelihood-Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Dimensional-Likelihood-Sampling" title="Permalink"></a></h2><p>Similarly, to sample a confidence set for an interest subset of the parameter vector, a &#39;dimensional profile&#39;, we use <a href="#LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_samples!"><code>dimensional_likelihood_samples!</code></a>. The sampled confidence set(s) will be contained within a <a href="../profile_structs/#LikelihoodBasedProfileWiseAnalysis.SampledConfidenceStruct"><code>SampledConfidenceStruct</code></a> that is stored in the <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a>.</p><p>Note: dimensional likelihood samples can be &#39;full&#39; likelihood samples as well. These will be computed before any other dimensional samples.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_samples!" href="#LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_samples!"><code>LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_samples!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dimensional_likelihood_samples!(model::LikelihoodModel,
    θindices::Vector{Vector{Int}},
    num_points_to_sample::Union{Int, Vector{Int}};
    &lt;keyword arguments&gt;)</code></pre><p>Samples <code>num_points_to_sample</code> points from interest parameter space, for each interest parameter combination in <code>θindices</code>, determining the values of nuisance parameters that maximise log-likelihood function at each, saving all points that are inside the <code>confidence_level</code> log-likelihood threshold. Saves these samples by modifying <code>model</code> in place.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.LikelihoodModel"><code>LikelihoodModel</code></a> containing model information, saved profiles and predictions.</li><li><code>θindices</code>: a vector of vectors of parameter indexes for the combinations of interest parameters to samples points from.</li><li><code>num_points_to_sample</code>: integer number of points to sample (for <a href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a> sample types). For the <a href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a> sample type, if integer it is the number of points to grid over in each parameter dimension. If it is a vector of integers each index of the vector is the number of points to grid over in the corresponding parameter dimension. For example, [1,2] would mean a single point in dimension 1 and two points in dimension 2. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>confidence_level</code>: a number ∈ (0.0, 1.0) for the confidence level to find samples within. Default is <code>0.95</code> (95%).</li><li><code>sample_type</code>: the sampling method used to sample parameter space. Available sample types are <a href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>UniformGridSamples</code></a>, <a href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>UniformRandomSamples</code></a> and <a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>. Default is <code>LatinHypercubeSamples()</code> (<a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LatinHypercubeSamples</code></a>).</li><li><code>lb</code>: optional vector of lower bounds on interest parameters. Use to specify interest parameter lower bounds to sample over that are different than those contained in <code>model.core</code> (must be the same length as original bounds). Default is <code>Float64[]</code> (use lower bounds from <code>model.core</code>).</li><li><code>ub</code>: optional vector of upper bounds on interest parameters. Use to specify interest parameter upper bounds to sample over that are different than those contained in <code>model.core</code> (must be the same length as original bounds). Default is <code>Float64[]</code> (use upper bounds from <code>model.core</code>).</li><li><code>θlb_nuisance</code>: a vector of lower bounds on nuisance parameters, require <code>θlb_nuisance .≤ model.core.θmle</code>. Default is <code>model.core.θlb</code>. </li><li><code>θub_nuisance</code>: a vector of upper bounds on nuisance parameters, require <code>θub_nuisance .≥ model.core.θmle</code>. Default is <code>model.core.θub</code>.</li><li><code>existing_profiles</code>: <code>Symbol ∈ [:ignore, :overwrite]</code> specifying what to do if samples already exist for a given <code>confidence_level</code> and <code>sample_type</code>. Default is <code>:overwrite</code>.</li><li><code>optimizationsettings</code>: a <a href="../../initialisation/#LikelihoodBasedProfileWiseAnalysis.OptimizationSettings"><code>OptimizationSettings</code></a> containing the optimisation settings used to find optimal values of nuisance parameters for a given interest parameter values. Default is <code>missing</code> (will use <code>model.core.optimizationsettings</code>).</li><li><code>show_progress</code>: boolean variable specifying whether to display progress bars on the percentage of <code>θcombinations</code> completed and estimated time of completion. Default is <code>model.show_progress</code>.</li><li><code>use_distributed</code>: boolean variable specifying whether to use a normal for loop or a <code>@distributed</code> for loop across combinations of interest parameters. Set this variable to <code>false</code> if <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> is not being used. Default is <code>true</code>.</li><li><code>use_threads</code>: boolean variable specifying, if <code>use_distributed</code> is false, to use a parallelised for loop across <code>Threads.nthreads()</code> threads to evaluate the log-likelihood at each sampled point. Default is <code>true</code>.</li></ul><p><strong>Details</strong></p><p>Using <a href="../../../internal_library/dimensional/#LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_sample"><code>dimensional_likelihood_sample</code></a> this function calls the sample method specified by <code>sample_type</code> for each set of interest parameters in <code>[θindices]</code> (depending on the setting for <code>existing_profiles</code> and <code>confidence_level</code> if these samples already exist). Updates <code>model.dim_samples_df</code> for each successful sample and saves their results as a <a href="../profile_structs/#LikelihoodBasedProfileWiseAnalysis.SampledConfidenceStruct"><code>SampledConfidenceStruct</code></a> in <code>model.dim_samples_dict</code>, where the keys for the dictionary is the row number in <code>model.dim_samples_df</code> of the corresponding sample. <code>model.dim_samples_df.num_points</code> is the number of points within the confidence boundary from those sampled.</p><div class="admonition is-info"><header class="admonition-header">Support for `dof`</header><div class="admonition-body"><p>Setting the degrees of freedom of a sampled parameter confidence set to a value other than the interest parameter dimensionality is not currently supported (e.g. as supported for univariate and bivariate profiles). Support may be added in the future, with a slight change in the API of this function.</p></div></div><p><strong>Extended help</strong></p><p><strong>Parallel Computing Implementation</strong></p><p>If <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed.jl</a> is being used <code>use_distributed</code> is <code>true</code>, then the dimensional samples of distinct interest parameter combinations will be computed in parallel across <code>Distributed.nworkers()</code> workers. If <code>use_distributed</code> is <code>false</code> and <code>use_threads</code> is <code>true</code> then the dimensional samples of each distinct interest parameter combination will be computed in parallel across <code>Threads.nthreads()</code> threads. It is highly recommended to set <code>use_threads</code> to <code>true</code> in that situation.</p><p><strong>Iteration Speed Of the Progress Meter</strong></p><p>The time/it value is the time it takes for each point chosen under the specified sampling scheme to be evaluated as valid or not, for each interest parameter combination. A point is valid if the log-likelihood function value at that point is greater than the confidence log-likelihood threshold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/dimensional_methods/dimensional_likelihood_sampling.jl#L424-L466">source</a></section><section><div><pre><code class="language-julia hljs">dimensional_likelihood_samples!(model::LikelihoodModel,
    θnames::Vector{Vector{Symbol}},
    num_points_to_sample::Union{Int, Vector{Int}};
    &lt;keyword arguments&gt;)</code></pre><p>Samples just the provided <code>θnames</code> interest parameter sets, provided as a vector of vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/dimensional_methods/dimensional_likelihood_sampling.jl#L658-L665">source</a></section><section><div><pre><code class="language-julia hljs">dimensional_likelihood_samples!(model::LikelihoodModel,
    sample_dimension::Int,
    sample_m_random_combinations::Int,
    num_points_to_sample::Union{Int, Vector{Int}}
    &lt;keyword arguments&gt;)</code></pre><p>Samples m random combinations of <code>sample_dimension</code> model parameters (sampling without replacement), where <code>0 &lt; m ≤ binomial(model.core.num_pars, sample_dimension)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/dimensional_methods/dimensional_likelihood_sampling.jl#L695-L703">source</a></section><section><div><pre><code class="language-julia hljs">dimensional_likelihood_samples!(model::LikelihoodModel,
    sample_dimension::Int,
    num_points_to_sample::Union{Int, Vector{Int}};
    &lt;keyword arguments&gt;)</code></pre><p>Samples all combinations of <code>sample_dimension</code> model parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/dimensional_methods/dimensional_likelihood_sampling.jl#L738-L745">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.get_dimensional_confidence_set" href="#LikelihoodBasedProfileWiseAnalysis.get_dimensional_confidence_set"><code>LikelihoodBasedProfileWiseAnalysis.get_dimensional_confidence_set</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_dimensional_confidence_set(model::LikelihoodModel, dim_row_number::Int)</code></pre><p>Returns the <a href="../profile_structs/#LikelihoodBasedProfileWiseAnalysis.SampledConfidenceStruct"><code>SampledConfidenceStruct</code></a> corresponding to the profile in row <code>dim_row_number</code> of <code>model.dim_samples_df</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/c9b92c011cefcb72f9d6cc463675ba628bb68d6c/src/dimensional_methods/dimensional_likelihood_sampling.jl#L1-L5">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#LikelihoodBasedProfileWiseAnalysis.AbstractSampleType"><code>LikelihoodBasedProfileWiseAnalysis.AbstractSampleType</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples"><code>LikelihoodBasedProfileWiseAnalysis.LatinHypercubeSamples</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.UniformGridSamples"><code>LikelihoodBasedProfileWiseAnalysis.UniformGridSamples</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples"><code>LikelihoodBasedProfileWiseAnalysis.UniformRandomSamples</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_samples!"><code>LikelihoodBasedProfileWiseAnalysis.dimensional_likelihood_samples!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample!"><code>LikelihoodBasedProfileWiseAnalysis.full_likelihood_sample!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.get_dimensional_confidence_set"><code>LikelihoodBasedProfileWiseAnalysis.get_dimensional_confidence_set</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bivariate/">« Bivariate Profiles</a><a class="docs-footer-nextpage" href="../../predictions/">Predictions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 28 October 2024 05:16">Monday 28 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
