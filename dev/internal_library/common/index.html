<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Common Functions · LikelihoodBasedProfileWiseAnalysis.jl</title><meta name="title" content="Common Functions · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="og:title" content="Common Functions · LikelihoodBasedProfileWiseAnalysis.jl"/><meta property="twitter:title" content="Common Functions · LikelihoodBasedProfileWiseAnalysis.jl"/><meta name="description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="twitter:description" content="Documentation for LikelihoodBasedProfileWiseAnalysis.jl."/><meta property="og:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/internal_library/common/"/><meta property="twitter:url" content="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/internal_library/common/"/><link rel="canonical" href="https://JoelTrent.github.io/LikelihoodBasedProfileWiseAnalysis.jl/internal_library/common/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LikelihoodBasedProfileWiseAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick Start</a></li><li><span class="tocitem">User Interface</span><ul><li><a class="tocitem" href="../../user_interface/initialisation/">Initialisation</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Parameter Profiles and Samples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../user_interface/profiles_and_samples/profile_structs/">Structs and Profile Types</a></li><li><a class="tocitem" href="../../user_interface/profiles_and_samples/univariate/">Univariate Profiles</a></li><li><a class="tocitem" href="../../user_interface/profiles_and_samples/bivariate/">Bivariate Profiles</a></li><li><a class="tocitem" href="../../user_interface/profiles_and_samples/dimensional/">Dimensional Samples</a></li></ul></li><li><a class="tocitem" href="../../user_interface/predictions/">Predictions</a></li><li><a class="tocitem" href="../../user_interface/plots/">Plots</a></li><li><a class="tocitem" href="../../user_interface/saving_and_loading/">Saving and Loading LikelihoodModels</a></li><li><a class="tocitem" href="../../user_interface/timing_and_profiling/">Timing and Profiling</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Simulated Coverage Checks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../user_interface/coverage/univariate_intervals/">Parameter Confidence Intervals</a></li><li><a class="tocitem" href="../../user_interface/coverage/bivariate_boundaries/">Bivariate Parameter Confidence Boundaries</a></li><li><a class="tocitem" href="../../user_interface/coverage/predictions_and_realisations/">Predictions and Realisations</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/">Initial Setup</a></li><li><a class="tocitem" href="../../examples/logistic/">Logistic Model</a></li><li><a class="tocitem" href="../../examples/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../../examples/two-species_logistic/">Two-Species Logistic Model</a></li><li><a class="tocitem" href="../../examples/binomial_normal_approximation/">Gaussian Approximation of a Binomial Distribution</a></li><li><a class="tocitem" href="../../examples/logistic_timing_estimates/">Function Evaluation Timing - Logistic Model</a></li></ul></li><li><span class="tocitem">Internal Library</span><ul><li class="is-active"><a class="tocitem" href>Common Functions</a><ul class="internal"><li><a class="tocitem" href="#Utility-and-Log-likelihood-Thresholds"><span>Utility and Log-likelihood Thresholds</span></a></li><li><a class="tocitem" href="#DataFrame-Subsets"><span>DataFrame Subsets</span></a></li><li><a class="tocitem" href="#Nuisance-Parameters-and-Array-Mapping"><span>Nuisance Parameters and Array Mapping</span></a></li></ul></li><li><a class="tocitem" href="../initialisation/">Initialisation</a></li><li><a class="tocitem" href="../ellipse_likelihood/">Ellipse Functions</a></li><li><a class="tocitem" href="../univariate/">Univariate Functions</a></li><li><a class="tocitem" href="../bivariate/">Bivariate Functions</a></li><li><a class="tocitem" href="../dimensional/">Dimensional Functions</a></li><li><a class="tocitem" href="../predictions/">Prediction Functions</a></li><li><a class="tocitem" href="../plots/">Plotting Functions</a></li><li><a class="tocitem" href="../coverage/">Coverage Functions</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internal Library</a></li><li class="is-active"><a href>Common Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Common Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/main/docs/src/internal_library/common.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Common-Functions"><a class="docs-heading-anchor" href="#Common-Functions">Common Functions</a><a id="Common-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Functions" title="Permalink"></a></h1><ul><li><a href="#LikelihoodBasedProfileWiseAnalysis.boundsmapping!"><code>LikelihoodBasedProfileWiseAnalysis.boundsmapping!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.convertθnames_toindices"><code>LikelihoodBasedProfileWiseAnalysis.convertθnames_toindices</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.correct_θbounds_nuisance"><code>LikelihoodBasedProfileWiseAnalysis.correct_θbounds_nuisance</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.desired_df_subset"><code>LikelihoodBasedProfileWiseAnalysis.desired_df_subset</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.get_consistent_tuple"><code>LikelihoodBasedProfileWiseAnalysis.get_consistent_tuple</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood"><code>LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.init_nuisance_parameters"><code>LikelihoodBasedProfileWiseAnalysis.init_nuisance_parameters</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.ll_correction"><code>LikelihoodBasedProfileWiseAnalysis.ll_correction</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.variablemapping!"><code>LikelihoodBasedProfileWiseAnalysis.variablemapping!</code></a></li><li><a href="#LikelihoodBasedProfileWiseAnalysis.variablemappingranges"><code>LikelihoodBasedProfileWiseAnalysis.variablemappingranges</code></a></li></ul><h2 id="Utility-and-Log-likelihood-Thresholds"><a class="docs-heading-anchor" href="#Utility-and-Log-likelihood-Thresholds">Utility and Log-likelihood Thresholds</a><a id="Utility-and-Log-likelihood-Thresholds-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-and-Log-likelihood-Thresholds" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.convertθnames_toindices" href="#LikelihoodBasedProfileWiseAnalysis.convertθnames_toindices"><code>LikelihoodBasedProfileWiseAnalysis.convertθnames_toindices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convertθnames_toindices(model::LikelihoodModel, 
    θnames_to_convert::Vector{&lt;:Symbol})</code></pre><p>Converts a vector of symbols representing parameters in <code>model</code> to a vector of each symbol&#39;s corresponding index in <code>model.core.θnames</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L63-L68">source</a></section><section><div><pre><code class="language-julia hljs">convertθnames_toindices(model::LikelihoodModel, 
    θnames_to_convert::Union{Vector{Vector{Symbol}}, Vector{Tuple{Symbol, Symbol}}})</code></pre><p>Converts a vector of vectors or tuples containing symbols representing parameters in <code>model</code> to a vector of vectors containing each symbol&#39;s corresponding index in <code>model.core.θnames</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L80-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.ll_correction" href="#LikelihoodBasedProfileWiseAnalysis.ll_correction"><code>LikelihoodBasedProfileWiseAnalysis.ll_correction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ll_correction(model::LikelihoodModel, 
    profile_type::AbstractProfileType, 
    ll::Float64)</code></pre><p>If a <code>profile_type</code> is <code>LogLikelihood()</code>, it corrects <code>ll</code> such that an input log-likelihood value (which has value of zero at the MLE) will now have a value of <code>model.core.maximisedmle</code> at the MLE. Otherwise, a copy of <code>ll</code> is returned, as both ellipse approximation profile types have a log-likelihood value of 0.0 at the MLE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L98-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood" href="#LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood"><code>LikelihoodBasedProfileWiseAnalysis.get_target_loglikelihood</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_target_loglikelihood(model::LikelihoodModel, 
    confidence_level::Float64, 
    profile_type::AbstractProfileType, 
    dof::Int)</code></pre><p>Returns the target log-likelihood / threshold at a confidence level and degrees of freedom, <code>dof</code> (typically the number of interest parameters OR the number of model parameters), required for a particular <code>profile_type</code> to be in the confidence set. Uses <a href="#LikelihoodBasedProfileWiseAnalysis.ll_correction"><code>LikelihoodBasedProfileWiseAnalysis.ll_correction</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L112-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.get_consistent_tuple" href="#LikelihoodBasedProfileWiseAnalysis.get_consistent_tuple"><code>LikelihoodBasedProfileWiseAnalysis.get_consistent_tuple</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_consistent_tuple(model::LikelihoodModel, 
    confidence_level::Float64, 
    profile_type::AbstractProfileType, 
    dof::Int)</code></pre><p>Returns a tuple containing the values needed for log-likelihood evaluation and finding function zeros, including the target log-likelihood, number of model parameters, log-likelihood function to use and <code>data</code> tuple for evaluating the log-likelihood function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L133-L140">source</a></section></article><h2 id="DataFrame-Subsets"><a class="docs-heading-anchor" href="#DataFrame-Subsets">DataFrame Subsets</a><a id="DataFrame-Subsets-1"></a><a class="docs-heading-anchor-permalink" href="#DataFrame-Subsets" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.desired_df_subset" href="#LikelihoodBasedProfileWiseAnalysis.desired_df_subset"><code>LikelihoodBasedProfileWiseAnalysis.desired_df_subset</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">desired_df_subset(df::DataFrame, 
    num_used_rows::Int, 
    confidence_levels::Union{Float64, Vector{&lt;:Float64}},
    dofs::Union{Int, Vector{&lt;:Int}}, 
    sample_types::Vector{&lt;:AbstractSampleType}; 
    sample_dimension::Int=0, 
    regions::Union{Real, Vector{&lt;:Real}}=Float64[],
    for_prediction_generation::Bool=false, 
    for_prediction_plots::Bool=false, 
    include_higher_confidence_levels::Bool=false)</code></pre><p>Returns a view of <code>df</code> that includes only valid rows ∈ <code>1:num_used_rows</code>, and rows that contain all of the values specified within function arguments. For dimensional samples.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: a DataFrame - <code>model.dim_samples_df</code>.</li><li><code>num_used_rows</code>: the number of valid rows in <code>df</code> - <code>model.num_dim_samples</code>.</li><li><code>confidence_levels</code>: a vector of confidence levels or a <code>Float64</code> of a single confidence level. If empty, all confidence levels in <code>df</code> are allowed. Otherwise, if <code>include_higher_confidence_levels == true</code> and <code>confidence_levels</code> is a <code>Float64</code>, all confidence levels greater than or equal to <code>confidence_levels</code> are allowed. Else, only matching confidence levels in <code>df</code> are allowed.</li><li><code>dofs</code>: a vector of integer degrees of freedom or a <code>Int</code> of a single degree of freedom. If empty, all degrees of freedom for dimensional profiles are allowed. Otherwise, only matching degrees of freedom in <code>df</code> are allowed.</li><li><code>sample_types</code>: a vector of <code>AbstractSampleType</code> structs. If empty, all sample types in <code>df</code> are allowed. Otherwise, only matching sample types in <code>df</code> are allowed.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>sample_dimension</code>: an integer greater than or equal to 0; if non-zero only matching dimensions of interest parameters in <code>df</code> are allowed, otherwise all are allowed. Default is <code>0</code>.</li><li><code>regions</code>: a vector of <code>Real</code> numbers ∈ [0, 1] or a single <code>Real</code> number specifying the regions in <code>df</code> that are allowed. If empty, all regions are allowed. Otherwise, only matching regions in <code>df</code> are allowed. Default is <code>Float64[]</code>.</li><li><code>for_prediction_generation</code>: a boolean specifying whether only rows which have not had predictions evaluated are allowed. As predictions do not need to be generated for rows which already have them evaluated. </li><li><code>for_prediction_plots</code>: a boolean specifying whether only rows which have had predictions evaluated are allowed. As prediction plots can only include rows which have evaluated predictions. </li><li><code>include_higher_confidence_levels</code>: a boolean specifying whether all confidence levels greater than or equal to <code>confidence_levels</code> are allowed. Useful for prediction plots as a dimensional sample can be evaluated at a high confidence level (e.g. 0.95) and then used at a lower confidence level (e.g. 0.9), extracting only the sample points that are in the 0.9 confidence set.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L161-L188">source</a></section><section><div><pre><code class="language-julia hljs">desired_df_subset(df::DataFrame, 
    num_used_rows::Int, 
    θs_of_interest::Vector{&lt;:Int}, 
    confidence_levels::Union{Float64, Vector{&lt;:Float64}}, 
    dofs::Union{Int, Vector{&lt;:Int}}, 
    profile_types::Vector{&lt;:AbstractProfileType}; 
    regions::Union{Real, Vector{&lt;:Real}}=Float64[],
    for_points_in_interval::Tuple{Bool,Int,Real}=(false,0,0), 
    for_prediction_generation::Bool=false, 
    for_prediction_plots::Bool=false)</code></pre><p>Returns a view of <code>df</code> that includes only valid rows ∈ <code>1:num_used_rows</code>, and rows that contain all of the values specified within function arguments. For univariate profiles.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: a DataFrame - <code>model.uni_profiles_df</code>.</li><li><code>num_used_rows</code>: the number of valid rows in <code>df</code> - <code>model.num_uni_profiles</code>.</li><li><code>confidence_levels</code>: a vector of confidence levels or a <code>Float64</code> of a single confidence level. If empty, all confidence levels in <code>df</code> are allowed. Otherwise, only matching confidence levels in <code>df</code> are allowed.</li><li><code>dofs</code>: a vector of integer degrees of freedom or a <code>Int</code> of a single degree of freedom. If empty, all degrees of freedom for univariate profiles are allowed. Otherwise, only matching degrees of freedom in <code>df</code> are allowed.</li><li><code>profile_types</code>: a vector of <code>AbstractProfileType</code> structs. If empty, all profile types in <code>df</code> are allowed. Otherwise, only matching profile types in <code>df</code> are allowed.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>regions</code>: a vector of <code>Real</code> numbers ∈ [0, 1] or a single <code>Real</code> number specifying the regions in <code>df</code> that are allowed. If empty, all regions are allowed. Otherwise, only matching regions in <code>df</code> are allowed. Default is <code>Float64[]</code>.</li><li><code>for_points_in_interval</code>: a tuple used for only extracting the rows that need to have points in the confidence interval evaluated by <a href="../../user_interface/profiles_and_samples/univariate/#LikelihoodBasedProfileWiseAnalysis.get_points_in_intervals!"><code>get_points_in_intervals!</code></a>. Default is <code>(false, 0, 0)</code>.</li><li><code>for_prediction_generation</code>: a boolean specifying whether only rows which have not had predictions evaluated are allowed. As predictions do not need to be generated for rows which already have them evaluated. </li><li><code>for_prediction_plots</code>: a boolean specifying whether only rows which have had predictions evaluated are allowed. As prediction plots can only include rows which have evaluated predictions. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L232-L258">source</a></section><section><div><pre><code class="language-julia hljs">desired_df_subset(df::DataFrame, 
    num_used_rows::Int, 
    θs_of_interest::Vector{Tuple{Int,Int}}, 
    confidence_levels::Union{Float64, Vector{&lt;:Float64}}, 
    dofs::Union{Int, Vector{&lt;:Int}}, 
    profile_types::Vector{&lt;:AbstractProfileType}, 
    methods::Vector{&lt;:AbstractBivariateMethod}=AbstractBivariateMethod[];
    regions::Union{Real, Vector{&lt;:Real}}=Float64[], 
    for_prediction_generation::Bool=false, 
    for_prediction_plots::Bool=false, 
    include_lower_confidence_levels::Bool=false)</code></pre><p>Returns a view of <code>df</code> that includes only valid rows ∈ <code>1:num_used_rows</code>, and rows that contain all of the values specified within function arguments. For bivariate profiles.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: a DataFrame - <code>model.biv_profiles_df</code>.</li><li><code>num_used_rows</code>: the number of valid rows in <code>df</code> - <code>model.num_biv_profiles</code>.</li><li><code>confidence_levels</code>: a vector of confidence levels or a <code>Float64</code> of a single confidence level. If empty, all confidence levels in <code>df</code> are allowed. Otherwise, if <code>include_lower_confidence_levels == true</code> and <code>confidence_levels</code> is a <code>Float64</code>, all confidence levels less than or equal to <code>confidence_levels</code> are allowed. Else, only matching confidence levels in <code>df</code> are allowed.</li><li><code>dofs</code>: a vector of integer degrees of freedom or a <code>Int</code> of a integer degree of freedom. If empty, all degrees of freedom for bivariate profiles are allowed. Otherwise, only matching degrees of freedom in <code>df</code> are allowed.</li><li><code>profile_types</code>: a vector of <code>AbstractProfileType</code> structs. If empty, all profile types in <code>df</code> are allowed. Otherwise, only matching profile types in <code>df</code> are allowed.</li><li><code>methods</code>: a vector of <code>AbstractBivariateMethod</code> structs. If empty, all methods in <code>df</code> are allowed. Otherwise, only methods of the same type in <code>df</code> are allowed.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>regions</code>: a vector of <code>Real</code> numbers ∈ [0, 1] or a single <code>Real</code> number specifying the regions in <code>df</code> that are allowed. If empty, all regions are allowed. Otherwise, only matching regions in <code>df</code> are allowed. Default is <code>Float64[]</code>.</li><li><code>for_prediction_generation</code>: a boolean specifying whether only rows which have not had predictions evaluated are allowed. As predictions do not need to be generated for rows which already have them evaluated. </li><li><code>for_prediction_plots</code>: a boolean specifying whether only rows which have had predictions evaluated are allowed. As prediction plots can only include rows which have evaluated predictions. </li><li><code>remove_combined_method</code>: a boolean specifiying whether rows with <code>method</code> of type <a href="../../user_interface/profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.CombinedBivariateMethod"><code>CombinedBivariateMethod</code></a> should be removed. Needed by <a href="../../user_interface/profiles_and_samples/bivariate/#LikelihoodBasedProfileWiseAnalysis.combine_bivariate_boundaries!"><code>combine_bivariate_boundaries!</code></a> to ensure that combined boundaries are not removed from <code>df</code>.</li><li><code>include_lower_confidence_levels</code>: a boolean specifying whether all confidence levels less than or equal to <code>confidence_levels</code> are allowed. Useful for prediction plots if a given set of bivariate profiles has few internal points evaluated, meaning some information about predictions may be missing. Bivariate profiles at lower confidence levels are by definition inside the desired confidence profile and may provide additional information on predictions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L306-L335">source</a></section></article><h2 id="Nuisance-Parameters-and-Array-Mapping"><a class="docs-heading-anchor" href="#Nuisance-Parameters-and-Array-Mapping">Nuisance Parameters and Array Mapping</a><a id="Nuisance-Parameters-and-Array-Mapping-1"></a><a class="docs-heading-anchor-permalink" href="#Nuisance-Parameters-and-Array-Mapping" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.variablemappingranges" href="#LikelihoodBasedProfileWiseAnalysis.variablemappingranges"><code>LikelihoodBasedProfileWiseAnalysis.variablemappingranges</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">variablemappingranges(num_pars::T, index::T) where T &lt;: Int</code></pre><p>Returns two tuples of ranges that map variables in nuisance parameter space (ω) to their corresponding indexes in parameter space (θ) given an interest parameter ψ at <code>index</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L1-L5">source</a></section><section><div><pre><code class="language-julia hljs">variablemappingranges(num_pars::T, index1::T, index2::T) where T &lt;: Int</code></pre><p>Returns two tuples of ranges that map variables in nuisance parameter space (ω) to their corresponding indexes in parameter space (θ), given interest parameters ψ at <code>index1</code> and <code>index2</code> and <code>index1 &lt; index2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.variablemapping!" href="#LikelihoodBasedProfileWiseAnalysis.variablemapping!"><code>LikelihoodBasedProfileWiseAnalysis.variablemapping!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">variablemapping!(θ::Union{Vector, SubArray}, ω::Union{Vector, SubArray}, θranges::Tuple{T, T}, ωranges::Tuple{T, T}) where T &lt;: UnitRange</code></pre><p>Modifies the array <code>θ</code> in place, mapping the variable values in the nuisance parameter array <code>ω</code> to their corresponding indexes in the parameter array <code>θ</code>, where the ranges are determined by <a href="#LikelihoodBasedProfileWiseAnalysis.variablemappingranges"><code>LikelihoodBasedProfileWiseAnalysis.variablemappingranges</code></a>. For one interest parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L24-L28">source</a></section><section><div><pre><code class="language-julia hljs">variablemapping!(θ::Union{Vector, SubArray}, ω::Union{Vector, SubArray}, θranges::Tuple{T,T,T}, ωranges::Tuple{T,T,T})) where T &lt;: UnitRange</code></pre><p>Modifies the array <code>θ</code> in place, mapping the variable values in the nuisance parameter array <code>ω</code> to their corresponding indexes in the parameter array <code>θ</code>, where the ranges are determined by <a href="#LikelihoodBasedProfileWiseAnalysis.variablemappingranges"><code>LikelihoodBasedProfileWiseAnalysis.variablemappingranges</code></a>. For two interest parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L38-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.boundsmapping!" href="#LikelihoodBasedProfileWiseAnalysis.boundsmapping!"><code>LikelihoodBasedProfileWiseAnalysis.boundsmapping!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">boundsmapping!(newbounds::Vector, bounds::AbstractVector, index::Int)</code></pre><p>Modifies <code>newbounds</code> in place, mapping all the values in <code>bounds</code> in order into <code>newbounds</code> with the exception of the value at <code>index</code>, which is the interest parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L53-L57">source</a></section><section><div><pre><code class="language-julia hljs">boundsmapping!(newbounds::Vector, bounds::AbstractVector, index1::Int, index2::Int)</code></pre><p>Modifies <code>newbounds</code> in place, mapping all the values in <code>bounds</code> in order into <code>newbounds</code> with the exception of the values at <code>index1</code> and <code>index2</code>, which are the interest parameters and <code>index1 &lt; index2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L64-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.init_nuisance_parameters" href="#LikelihoodBasedProfileWiseAnalysis.init_nuisance_parameters"><code>LikelihoodBasedProfileWiseAnalysis.init_nuisance_parameters</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">init_nuisance_parameters(model::LikelihoodModel, index::Int)</code></pre><p>Initialises the lower and upper bounds, and initial guess for nuisance parameters using <a href="#LikelihoodBasedProfileWiseAnalysis.boundsmapping!"><code>LikelihoodBasedProfileWiseAnalysis.boundsmapping!</code></a> and ranges that map variables between nuisance parameter and parameter space using <a href="#LikelihoodBasedProfileWiseAnalysis.variablemappingranges"><code>LikelihoodBasedProfileWiseAnalysis.variablemappingranges</code></a>, given an interest parameter at <code>index</code>. The initial guess for nuisance parameters is their corresponding value at the maximum likelihood estimate (<code>model.core.θmle</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L76-L80">source</a></section><section><div><pre><code class="language-julia hljs">init_nuisance_parameters(model::LikelihoodModel, index::Int)</code></pre><p>Initialises the lower and upper bounds, and initial guess for nuisance parameters using <a href="#LikelihoodBasedProfileWiseAnalysis.boundsmapping!"><code>LikelihoodBasedProfileWiseAnalysis.boundsmapping!</code></a> and ranges that map variables between nuisance parameter and parameter space using <a href="#LikelihoodBasedProfileWiseAnalysis.variablemappingranges"><code>LikelihoodBasedProfileWiseAnalysis.variablemappingranges</code></a>, given interest parameters at <code>index1</code> and <code>index2</code> where <code>index1 &lt; index2</code>. The initial guess for nuisance parameters is their corresponding value at the maximum likelihood estimate (<code>model.core.θmle</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L95-L99">source</a></section><section><div><pre><code class="language-julia hljs">init_nuisance_parameters(model::LikelihoodModel, index::Int)</code></pre><p>Initialises the lower and upper bounds, and initial guess for nuisance parameters and indices that map variables between parameter and nuisance parameter space, given interest parameters in <code>θindices</code>. The initial guess for nuisance parameters is their corresponding value at the maximum likelihood estimate (<code>model.core.θmle</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/nuisance_parameters_and_array_mapping.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LikelihoodBasedProfileWiseAnalysis.correct_θbounds_nuisance" href="#LikelihoodBasedProfileWiseAnalysis.correct_θbounds_nuisance"><code>LikelihoodBasedProfileWiseAnalysis.correct_θbounds_nuisance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">correct_θbounds_nuisance(m::LikelihoodModel,
    θlb_nuisance::AbstractVector{&lt;:Float64},
    θub_nuisance::AbstractVector{&lt;:Float64})</code></pre><p>Makes sure that nuisance parameter bounds contain the MLE parameter values - if not, set that part of the nuisance parameter bound to the bounds in <code>model.core</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoelTrent/LikelihoodBasedProfileWiseAnalysis.jl/blob/a2229b1559204c9a76c46da05466510a7a794d8a/src/common_profile_likelihood.jl#L1-L7">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examples/logistic_timing_estimates/">« Function Evaluation Timing - Logistic Model</a><a class="docs-footer-nextpage" href="../initialisation/">Initialisation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 8 February 2024 04:36">Thursday 8 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
